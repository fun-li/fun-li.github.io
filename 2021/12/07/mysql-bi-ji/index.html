<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="MySQL笔记, fun-ny Blog">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>MySQL笔记 | fun-ny Blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">fun-ny Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">fun-ny Blog</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://imag.fun-ny.cn/14619529_1638882944.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">MySQL笔记</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Mysql/">
                                <span class="chip bg-color">Mysql</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-category">
                                数据库
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-12-07
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-12-09
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    16.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    64 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="1-MySQL的使用"><a href="#1-MySQL的使用" class="headerlink" title="1 MySQL的使用"></a>1 MySQL的使用</h1><h2 id="1-1-MySQL服务的启动"><a href="#1-1-MySQL服务的启动" class="headerlink" title="1.1 MySQL服务的启动"></a>1.1 MySQL服务的启动</h2><p>“我的电脑/计算机”–&gt;右键–&gt;“管理”–&gt;“服务”–&gt;启动和关闭MySQL服务</p>
<p>“开始菜单”–&gt;“控制面板”–&gt;“管理工具”–&gt;“服务”–&gt;启动和关闭MySQL</p>
<p>“任务管理器”–&gt;“服务”–&gt;启动和关闭MySQL</p>
<p><img src="http://imag.fun-ny.cn/img/wps10.jpg" alt="img">    <img src="http://imag.fun-ny.cn/img/wps11.jpg" alt="img"></p>
<p>或者</p>
<p>命令行（使用命令行的前提需要配置mysql的环境变量）</p>
<pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">net  start  MySQL服务名
net  stop  MySQL服务名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="1-2-客户端连接MySQL"><a href="#1-2-客户端连接MySQL" class="headerlink" title="1.2 客户端连接MySQL"></a>1.2 客户端连接MySQL</h2><p>1、命令行客户端：</p>
<pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">mysql -h 主机IP地址 -P 端口号	-u 用户名	-p回车
Enter Password:密码<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<blockquote>
<p>如果访问本机，-h localhost可以省略</p>
<p>如果端口号没有修改，-P 3306可以省略</p>
<p>除了-p与密码之间不要空格外，其他的-h,-P,-u与后面的参数值之间可以有空格</p>
<p>想要连接成功，必须保证服务开启的</p>
</blockquote>
<p>2、其他客户端，例如：可视化工具Navicat或SQLyog等</p>
<p><img src="http://imag.fun-ny.cn/img/1557378069584.png" alt="1557378069584"></p>
<h1 id="2-MySQL数据类型和运算符"><a href="#2-MySQL数据类型和运算符" class="headerlink" title="2  MySQL数据类型和运算符"></a>2  MySQL数据类型和运算符</h1><h2 id="2-1-MySQL数据类型"><a href="#2-1-MySQL数据类型" class="headerlink" title="2.1 MySQL数据类型"></a>2.1 MySQL数据类型</h2><h3 id="1、数值类型"><a href="#1、数值类型" class="headerlink" title="1、数值类型"></a>1、数值类型</h3><ul>
<li>整型系列：xxxInt3</li>
</ul>
<blockquote>
<p>int(M)，必须和unsigned zerofill一起使用才有意义</p>
</blockquote>
<p><img src="http://imag.fun-ny.cn/img/1560933629123.png" alt="1560933629123"></p>
<ul>
<li>浮点型系列：float,double（或real)</li>
</ul>
<blockquote>
<p>double(M,D)：表示最长为M位，其中小数点后D位</p>
<p>例如：double(5,2)表示的数据范围[-999.99,999.99]，如果超过这个范围会报错。</p>
</blockquote>
<ul>
<li>定点型系列：decimal（底层实际上是使用字符串进行存储）</li>
</ul>
<blockquote>
<p>decimal(M,D)：表示最长为M位，其中小数点后D位</p>
</blockquote>
<ul>
<li>位类型：bit</li>
</ul>
<p>字节范围是：1-8，值范围是：bit(1)~bit(64)，默认bit(1) 将传入的数值转为二进制存入</p>
<p>用来存储二进制数。对于位字段，直接使用select命令将不会看到结果。可以使用bit()函数进行插入。插入bit类型字段时，使用bit()函数转为二进制值再插入，使用bin()函数进行读取。</p>
<h3 id="2、日期时间类型"><a href="#2、日期时间类型" class="headerlink" title="2、日期时间类型"></a>2、日期时间类型</h3><p>日期时间类型：year, date, datetime, timestamp</p>
<blockquote>
<p>注意一下每一种日期时间的表示范围</p>
</blockquote>
<p><img src="http://imag.fun-ny.cn/img/1560933691657.png" alt="1560933691657"></p>
<p>timestamp和datetime的区别：</p>
<ul>
<li><p>timestamp范围比较小</p>
</li>
<li><p>timestamp和时区有关</p>
<ul>
<li>show variables like ‘time_zone’;</li>
<li>set time_zone = ‘+9:00’;</li>
</ul>
</li>
<li><p>表中的第一个非空的timestamp字段如果插入和更新为NULL则会自动设置为系统时间</p>
</li>
</ul>
<p><img src="http://imag.fun-ny.cn/img/image-20200406171844833.png" alt="image-20200406171844833"></p>
<p><img src="http://imag.fun-ny.cn/img/image-20200406171900814.png" alt="image-20200406171900814"></p>
<h3 id="3、字符串类型"><a href="#3、字符串类型" class="headerlink" title="3、字符串类型"></a>3、字符串类型</h3><p>MySQL中提供了多种对字符数据的存储类型，不同的版本可能有所差异。常见的有：</p>
<p>char,varchar，xxtext，binary，varbinary，xxblob，enum，set等等</p>
<p><img src="http://imag.fun-ny.cn/img/image-20200406180437224.png" alt="image-20200406180437224"></p>
<ul>
<li>字符串类型char,varchar(M)</li>
</ul>
<blockquote>
<p>char如果没有指定宽度，默认为1个字符</p>
<p>varchar(M)，必须指定宽度</p>
</blockquote>
<ul>
<li><p>binary和varbinary类似于char和varchar，不同的是它们包含二进制字符串，不支持模糊查询之类的。</p>
</li>
<li><p>一般在保存少量字符串的时候，我们会选择char和varchar；而在保存较大文本时，通常会选择使用text或blob系列。blob和text值会引起一些性能问题，特别是在执行了大量的删除操作时，会在数据表中留下很大的“空洞”，为了提高性能，建议定期时候用optimize table功能对这类表进行碎片整理。可以使用合成的(Synthetic)索引来提高大文本字段的查询性能，如果需要对大文本字段进行模糊查询，MySql提供了前缀索引。但是仍然要在不必要的时候避免检索大型的blob或text值。</p>
</li>
<li><p>enum枚举类型，它的值范围需要在创建表时通过枚举方式显式指定，对于1~255个成员的枚举需要1个字节存储；对于255`65535个成员需要2个字节存储。例如：gender enum(‘男’,’女’)。一次只能从枚举值中选择一个。</p>
</li>
<li><p>set集合类型，可以包含0~64个成员。一次可以从集合中选择多个成员。如果选择了1-8个成员的集合，占1个字节，依次占2个，3个。。8个字节。例如：hoppy  set(‘吃饭’,’睡觉’,’玩游戏’,’旅游’)，选择时’吃饭,睡觉’或’睡觉,玩游戏,旅游’</p>
</li>
</ul>
<h3 id="4、示例"><a href="#4、示例" class="headerlink" title="4、示例"></a>4、示例</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">+</span><span class="token comment">----------------+--------------+------+-----+---------+----------------+</span>
<span class="token operator">|</span> Field          <span class="token operator">|</span> <span class="token keyword">Type</span>         <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+--------------+------+-----+---------+----------------+</span>
<span class="token operator">|</span> eid            <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token keyword">auto_increment</span> <span class="token operator">|</span>
<span class="token operator">|</span> ename          <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> tel            <span class="token operator">|</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> gender         <span class="token operator">|</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>      <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> 男        <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> salary         <span class="token operator">|</span> <span class="token keyword">double</span>       <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> commission_pct <span class="token operator">|</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> birthday       <span class="token operator">|</span> <span class="token keyword">date</span>         <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> hiredate       <span class="token operator">|</span> <span class="token keyword">date</span>         <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> job_id         <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> email          <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>  <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> mid            <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> address        <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> native_place   <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> did            <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+--------------+------+-----+---------+----------------+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="3-SQL"><a href="#3-SQL" class="headerlink" title="3 SQL"></a>3 SQL</h1><h2 id="3-1-MySQL的语法规范和要求"><a href="#3-1-MySQL的语法规范和要求" class="headerlink" title="3.1 MySQL的语法规范和要求"></a>3.1 MySQL的语法规范和要求</h2><p>（1）mysql的sql语法不区分大小写</p>
<blockquote>
<p>MySQL的关键字和函数名等不区分大小写，但是对于数据值是否区分大小写，和字符集与校对规则有关。</p>
</blockquote>
<p>_ci（大小写不敏感），_cs（大小写敏感），_bin（二元，即比较是基于字符编码的值而与language无关，区分大小写）</p>
<p>（2）命名时：尽量使用26个英文字母大小写，数字0-9，下划线，不要使用其他符号</p>
<p>（3）建议不要使用mysql的关键字等来作为表名、字段名等，如果不小心使用，请在SQL语句中使用`（飘号）引起来</p>
<p>（4）数据库和表名、字段名等对象名中间不要包含空格</p>
<p>（5）同一个mysql软件中，数据库不能同名，同一个库中，表不能重名，同一个表中，字段不能重名</p>
<p>（6）标点符号：</p>
<blockquote>
<p>必须成对</p>
<p>必须英文状态下半角输入方式</p>
<p>字符串和日期类型可以使用单引号’’</p>
<p>列的别名可以使用双引号””，给表名取别名不要使用双引号。取别名时as可以省略</p>
<p>如果列的别名没有包含空格，可以省略双引号，如果有空格双引号不能省略。</p>
</blockquote>
<p>（7）SQL脚本中如何加注释</p>
<blockquote>
<p>单行注释：#注释内容</p>
<p>单行注释：–空格注释内容    其中–后面的空格必须有</p>
<p>多行注释：/* 注释内容 */</p>
</blockquote>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#以下两句是一样的，不区分大小写</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span><span class="token punctuation">;</span>

<span class="token comment">#创建表格</span>
<span class="token comment">#create table student info(...); #表名错误，因为表名有空格</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> student_info<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">#其中name使用``飘号，因为name和系统关键字或系统函数名等预定义标识符重名了。</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t_stu<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> id <span class="token keyword">as</span> <span class="token string">"编号"</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>name<span class="token punctuation">`</span> <span class="token keyword">as</span> <span class="token string">"姓名"</span> <span class="token keyword">from</span> t_stu<span class="token punctuation">;</span> <span class="token comment">#起别名时，as都可以省略</span>
<span class="token keyword">select</span> id <span class="token keyword">as</span> 编号<span class="token punctuation">,</span> <span class="token punctuation">`</span>name<span class="token punctuation">`</span> <span class="token keyword">as</span> 姓名 <span class="token keyword">from</span> t_stu<span class="token punctuation">;</span> <span class="token comment">#如果字段别名中没有空格，那么可以省略""</span>
<span class="token keyword">select</span> id <span class="token keyword">as</span> 编 号<span class="token punctuation">,</span> <span class="token punctuation">`</span>name<span class="token punctuation">`</span> <span class="token keyword">as</span> 姓 名 <span class="token keyword">from</span> t_stu<span class="token punctuation">;</span> <span class="token comment">#错误，如果字段别名中有空格，那么不能省略""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-2-SQL分类"><a href="#3-2-SQL分类" class="headerlink" title="3.2 SQL分类"></a>3.2 SQL分类</h2><ul>
<li><p>DDL (Data Definition Language) ：数据定义语言，定义库，表结构等，包括create,drop,alter等</p>
</li>
<li><p>DML (Data Manipulation Language) ：数据操作语言，增删改查数据，包括insert,delete,update,select等</p>
</li>
<li><p>DQL(Data query Language):数据查询语言 select</p>
</li>
<li><p>DCL（Data Control Language） ：数据控制语言，权限，事务等管理。</p>
</li>
</ul>
<h2 id="3-3-DDL-v1-0"><a href="#3-3-DDL-v1-0" class="headerlink" title="3.3 DDL(v1.0)"></a>3.3 DDL(v1.0)</h2><p>1、查看所有数据库</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>2、指定使用某个数据库</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">use</span> 数据库名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>3、创建数据库</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> 数据库名<span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">database</span> 数据库名 <span class="token keyword">charset</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span> <span class="token comment">#在mysql中字符集名称不要使用utf-8</span>

<span class="token keyword">create</span> <span class="token keyword">database</span> 数据库名 <span class="token keyword">charset</span> <span class="token string">'gbk'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>4、删除数据库</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">drop</span> <span class="token keyword">database</span> 数据库名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>5、查看某个库下的所有表格</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token punctuation">;</span>  <span class="token comment">#前提是前面有use 数据库名;的语句</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token keyword">from</span> 数据库名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>6、创建表格</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型<span class="token punctuation">,</span>
	字段名<span class="token number">2</span> 数据类型<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>7、删除表格</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>8、查看某个表结构</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">describe</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">;</span>
<span class="token keyword">desc</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>9、增加一列</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">add</span> 【<span class="token keyword">column</span>】 字段名 数据类型<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">add</span> 【<span class="token keyword">column</span>】 字段名 数据类型 <span class="token keyword">first</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">add</span> 【<span class="token keyword">column</span>】 字段名 数据类型 <span class="token keyword">after</span> 另一个字段<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>10、删除一列</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">drop</span> 【<span class="token keyword">column</span>】 字段名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>11、修改列数据类型</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">modify</span> 【<span class="token keyword">column</span>】 字段名 新数据类型<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>12、修改列名</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 change【<span class="token keyword">column</span>】 旧字段名 新字段名 新数据类型<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>13、修改列的位置</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">modify</span> 【<span class="token keyword">column</span>】字段名 数据类型 <span class="token keyword">first</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">modify</span> 【<span class="token keyword">column</span>】字段名 数据类型 <span class="token keyword">after</span> 另一个字段<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>14、修改表名称</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 旧表名 <span class="token keyword">rename</span> 新表名<span class="token punctuation">;</span>
<span class="token keyword">rename</span> <span class="token keyword">table</span> 旧表名 <span class="token keyword">to</span> 新表名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h2 id="3-4-DML-v1-0"><a href="#3-4-DML-v1-0" class="headerlink" title="3.4 DML(v1.0)"></a>3.4 DML(v1.0)</h2><p>1、添加数据</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">values</span><span class="token punctuation">(</span>值列表<span class="token punctuation">)</span>； 
<span class="token comment">#要求值列表的顺序、个数、类型，要与表格中的字段的顺序、个数、类型一一匹配</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">(</span>部分字段列表<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>值列表<span class="token punctuation">)</span>；
<span class="token comment">#要求列表的顺序、个数、类型，要与前面的(部分字段列表)的顺序、个数、类型一一匹配</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">values</span><span class="token punctuation">(</span>值列表<span class="token number">1</span><span class="token punctuation">)</span>，<span class="token punctuation">(</span>值列表<span class="token number">2</span><span class="token punctuation">)</span>。。。<span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">(</span>部分字段列表<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>值列表<span class="token number">1</span><span class="token punctuation">)</span>，<span class="token punctuation">(</span>值列表<span class="token number">2</span><span class="token punctuation">)</span>。。。<span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token punctuation">[</span>数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名 <span class="token keyword">set</span> 字段名<span class="token operator">=</span>值<span class="token punctuation">,</span> 字段名<span class="token operator">=</span>值<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>2、修改数据</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">set</span> 字段名<span class="token number">1</span> <span class="token operator">=</span> 值<span class="token number">1</span><span class="token punctuation">,</span> 字段名<span class="token number">2</span> <span class="token operator">=</span> 值<span class="token number">2</span> 。。。 【<span class="token keyword">where</span> 条件】<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>如果没有加where条件，表示修改所有行，这个字段的值</p>
</blockquote>
<p>3、删除数据</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 【<span class="token keyword">where</span> 条件】<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>如果没有where条件，表示删除整张表的数据;</p>
</blockquote>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">truncate</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">;</span><span class="token comment">#删除整张表的数据，还可以使用这个语句，效率更高，但是它不能回滚</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>用delete删除整张表和用truncate删除整张表的数据的区别？</p>
<p>（1）truncate速度快</p>
<p>（2）truncate无法回滚</p>
<p>truncate因为底层是把表drop掉，然后新建了一张空表。</p>
<p>delete因为底层是一行一行删数据。</p>
<p>4、简单查询数据</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">;</span> <span class="token comment">#查询整张表的所有数据</span>

<span class="token keyword">select</span> 字段列表  <span class="token keyword">from</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">;</span>  <span class="token comment">#查询部分列表</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 【<span class="token keyword">where</span> 条件】<span class="token punctuation">;</span>

<span class="token keyword">select</span> 字段列表  <span class="token keyword">from</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 【<span class="token keyword">where</span> 条件】<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>使用distinct可以对查询结果进行去重</p>
</blockquote>
<h2 id="3-5-导入和导出数据"><a href="#3-5-导入和导出数据" class="headerlink" title="3.5 导入和导出数据"></a>3.5 导入和导出数据</h2><h3 id="3-5-1-单个数据库备份"><a href="#3-5-1-单个数据库备份" class="headerlink" title="3.5.1 单个数据库备份"></a>3.5.1 单个数据库备份</h3><p>mysql5.5</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">C:\Windows\System32<span class="token operator">&gt;</span> mysqldump <span class="token operator">-</span>h主机地址 <span class="token operator">-</span>P端口号 <span class="token operator">-</span>u用户名 <span class="token operator">-</span>p密码 <span class="token comment">--database  数据名 &gt; 文件路径/文件名.sql</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>例如：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">C:\Windows\System32<span class="token operator">&gt;</span>mysqldump <span class="token operator">-</span>hlocalhost <span class="token operator">-</span>P3306 <span class="token operator">-</span>uroot <span class="token operator">-</span>p123456 <span class="token comment">--database  test &gt; d:/test.sql</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="http://imag.fun-ny.cn/img/1560928457771.png" alt="1560928457771"></p>
<p>mysql5.7版</p>
<pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">C:\Windows\System32&gt; mysqldump -h主机地址 -P端口号 -u用户名 -p 数据库名 &gt; 文件路径/文件名.sql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>本机操作可以省略主机名和端口号</p>
<pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">C:\Users\Administrator&gt;mysqldump -uroot -p book &gt;d:/dump.sql
Enter password: ****<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<blockquote>
<p>不要再写–database</p>
</blockquote>
<h3 id="3-5-2-导入执行备份的sql脚本"><a href="#3-5-2-导入执行备份的sql脚本" class="headerlink" title="3.5.2 导入执行备份的sql脚本"></a>3.5.2 导入执行备份的sql脚本</h3><p>先登录mysql，然后执行如下命令：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">mysql<span class="token operator">&gt;</span> source  <span class="token keyword">sql</span>脚本路径名<span class="token punctuation">.</span><span class="token keyword">sql</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>例如：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">mysql<span class="token operator">&gt;</span>source d:<span class="token operator">/</span>test<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="http://imag.fun-ny.cn/img/1560928671347.png" alt="1560928671347"></p>
<h2 id="3-6-MySQL运算符"><a href="#3-6-MySQL运算符" class="headerlink" title="3.6 MySQL运算符"></a>3.6 MySQL运算符</h2><p>1、算术运算符</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">加：<span class="token operator">+</span>
减：<span class="token operator">-</span>
乘：<span class="token operator">*</span>
除：<span class="token operator">/</span>   <span class="token operator">div</span>（只保留整数部分）
模：<span class="token operator">%</span>   mod<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>2、比较运算符</p>
<pre class="line-numbers language-none"><code class="language-none">大于：&gt;
小于：&lt;
大于等于：&gt;=
小于等于：&gt;=
等于：=   不能用于null判断
不等于：!=  或 &lt;&gt;
安全等于：&lt;=&gt;  可以用于null值判断<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>3、逻辑运算符（建议用单词，可读性来说）</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">逻辑与：<span class="token operator">&amp;&amp;</span> 或 <span class="token operator">and</span>
逻辑或：<span class="token operator">||</span> 或 <span class="token operator">or</span>
逻辑非：<span class="token operator">!</span> 或 <span class="token operator">not</span>
逻辑异或： <span class="token operator">xor</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>4、范围</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">区间范围：<span class="token operator">between</span> x  <span class="token operator">and</span>  y
	    <span class="token operator">not</span> <span class="token operator">between</span> x  <span class="token operator">and</span>  y
集合范围：<span class="token operator">in</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>x<span class="token punctuation">,</span>x<span class="token punctuation">)</span>
	    <span class="token operator">not</span>  <span class="token operator">in</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>x<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>5、模糊查询和正则匹配（只针对字符串类型，日期类型）</p>
<pre class="line-numbers language-none"><code class="language-none">like 'xxx'
如果想要表示0~n个字符，用%
如果想要表示确定的1个字符，用_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<p>6、位运算符（很少使用）</p>
<pre class="line-numbers language-none"><code class="language-none">左移：&lt;&lt;
右移：&gt;&gt;
按位与：&amp;
按位或：|
按位异或：^
按位取反：~<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>7、特殊的null值处理</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#（1）判断时</span>
xx <span class="token operator">is</span> <span class="token boolean">null</span>
xx <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
xx <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">/*一、运算符
1、算术运算符
+：加
-：减
*：乘
/：除 可以保留小数部分
div：除  如果整数与整数相除只保留整数部分
%：求余数
mod：求余数
*/</span>
<span class="token keyword">select</span> <span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">#0.5</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token operator">div</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">#0</span>

<span class="token comment">/*
2、比较运算符
&gt;：大于
&lt;：小于
=：等于  注意区别，Java中是==,mysql中是=
&gt;=：大于等于
&lt;=：小于等于
!=：不等于
&lt;&gt;：不等于
&lt;=&gt;：安全等于  用于判断null值的比较运算符
		null值的判断，习惯上我们用is null 和is not null
*/</span>
<span class="token comment">#查询薪资大于20000元的员工</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token number">20000</span><span class="token punctuation">;</span>

<span class="token comment">#查询所有男员工</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> gender <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> gender <span class="token operator">!=</span> <span class="token string">'女'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> gender <span class="token operator">&lt;&gt;</span> <span class="token string">'女'</span><span class="token punctuation">;</span>

<span class="token comment">#查询奖金比例commision_pct是null的员工</span>
<span class="token keyword">select</span>  <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> commission_pct <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token keyword">select</span>  <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> commission_pct <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">/*
3、逻辑运算符
&amp;&amp;和and：逻辑与
	两个条件同时满足
||和or：逻辑或
	两个条件满足任意一个
^和xor：逻辑异或
!和not：
	不满足xx条件
	*/</span>
<span class="token comment">#查询薪资大于20000元的女员工	</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token number">20000</span> <span class="token operator">&amp;&amp;</span> gender <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token number">20000</span> <span class="token operator">and</span> gender <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">;</span>

<span class="token comment">#查询男员工</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> <span class="token operator">not</span> gender <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> <span class="token operator">!</span><span class="token punctuation">(</span>gender <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#查询薪资大于10000  异或 性别是男的，即它俩只能满足一个</span>
<span class="token comment">#即查询薪资大于10000的女的或薪资低于10000的男的</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary<span class="token operator">&gt;</span><span class="token number">10000</span> <span class="token operator">^</span> gender <span class="token operator">=</span><span class="token string">'男'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary<span class="token operator">&gt;</span><span class="token number">10000</span> <span class="token operator">xor</span> gender <span class="token operator">=</span><span class="token string">'男'</span><span class="token punctuation">;</span>
<span class="token comment">/*
4、范围
（1）区间范围：
	在[a,b]之间，between a and b
	不在[a,b]之间，not between a and b
（2）集合范围
	in(...)
	not in(...)
*/</span>
<span class="token comment">#查询薪资在[15000,20000]之间的员工</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary <span class="token operator">between</span> <span class="token number">15000</span> <span class="token operator">and</span> <span class="token number">20000</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary <span class="token operator">&gt;=</span> <span class="token number">15000</span> <span class="token operator">and</span> salary <span class="token operator">&lt;=</span><span class="token number">20000</span><span class="token punctuation">;</span>

<span class="token comment">#查询薪资在9000,10000,12000</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">9000</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">12000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> salary <span class="token operator">=</span><span class="token number">9000</span> <span class="token operator">||</span> salary <span class="token operator">=</span><span class="token number">10000</span> <span class="token operator">||</span> salary <span class="token operator">=</span><span class="token number">12000</span><span class="token punctuation">;</span>
 <span class="token comment">/*
5、模糊查询
like '%x%' x代表确定的字符 %表示不确定的0~n个字符
     '_x%'  x代表确定的字符 _表示确定的1个字符
   
*/</span>
<span class="token comment">#查询，名字ename中包含“冰”这个字的员工</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'%冰%'</span><span class="token punctuation">;</span>

<span class="token comment">#查询，名字ename是张xx，三个字</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'张__'</span><span class="token punctuation">;</span>

<span class="token comment">#查询，名字ename是第二个字是'冰'</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_employee <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'_冰%'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="4-约束与索引"><a href="#4-约束与索引" class="headerlink" title="4  约束与索引"></a>4  约束与索引</h1><h2 id="4-1-约束与索引的概念"><a href="#4-1-约束与索引的概念" class="headerlink" title="4.1 约束与索引的概念"></a>4.1 约束与索引的概念</h2><p>约束是用来对数据业务规则和数据完整性进行实施、维护。约束的作用范围仅限在当前数据库，约束可以被当做<strong>数据库对象</strong>来处理，它们具有名称和关联模式，是逻辑约束，不会因为设置约束而额外占用空间。</p>
<p>1、数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是应防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。</p>
<p>数据的完整性要从以下四个方面考虑：</p>
<ul>
<li>实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录</li>
<li>域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女”</li>
<li>引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门</li>
<li>用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。</li>
</ul>
<p>2、根据约束的特点，分为几种：</p>
<ul>
<li>键约束：主键约束、外键约束、唯一键约束</li>
<li>Not NULL约束：非空约束</li>
<li>Check约束：检查约束(5.7版本不支持)</li>
<li>Default约束：默认值约束</li>
<li>自增约束</li>
</ul>
<p>3、约束（CONSTRAINTS）与索引（INDEX）</p>
<p><strong>索引</strong>是一个单独、物理的存储在数据页上的数据库结构，它是表中<strong>一列或若干列值的集合</strong>和相应的指向表中数据值的物理标识数据页的<strong>逻辑指针清单</strong>（类似于新华字典的目录索引页）。索引的存在会增加数据库的存储空间，也会使插入、修改数据的时间开销变多(因为插入和修改数据时，索引也要随之变动），但是可以大大提高查询速度。因此应该在键列、或其他经常要查询、排序、按范围查找的列上建立索引，而对于在查询中很少使用和参考的列、修改非常频繁的列，值很少的列（例如性别只有男和女）等列上不应该创建索引。</p>
<p><img src="http://imag.fun-ny.cn/img/1599525278469.png" alt="1599525278469"></p>
<blockquote>
<p>Mysql会在主键、唯一键、外键列上自动创建索引，其他列需要建立索引的话，需要手动创建。</p>
<p>其中主键删除，对应的索引也会删除</p>
<p>删除唯一键的方式是通过删除对应的索引来实现的</p>
<p>删除外键，外键列上的索引还在，如果需要删除，需要单独删除索引</p>
</blockquote>
<h2 id="4-2-DDL-v2-0"><a href="#4-2-DDL-v2-0" class="headerlink" title="4.2  DDL(v2.0)"></a>4.2  DDL(v2.0)</h2><h3 id="1、查看某个表的约束"><a href="#1、查看某个表的约束" class="headerlink" title="1、查看某个表的约束"></a>1、查看某个表的约束</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>table_constraints <span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'表名称'</span><span class="token punctuation">;</span>
或
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="2、查看某个表的索引"><a href="#2、查看某个表的索引" class="headerlink" title="2、查看某个表的索引"></a>2、查看某个表的索引</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> 表名称<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="3、主键约束：primary-key"><a href="#3、主键约束：primary-key" class="headerlink" title="3、主键约束：primary key"></a>3、主键约束：primary key</h3><p>主键分为单列主键和复合主键：</p>
<p><img src="http://imag.fun-ny.cn/img/1561002222421.png" alt="1561002222421"></p>
<p>主键的特点：（1）唯一并且非空（2）一个表只能有一个主键约束（3）主键约束名就叫做PRIMARY（4）创建主键会自动创建对应的索引，同样删除主键对应的索引也会删除。</p>
<p>（1）如何在建表时指定主键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
或
<span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
或
<span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
    字段名<span class="token number">1</span> 数据类型<span class="token punctuation">,</span>
    字段名<span class="token number">2</span> 数据类型<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>复合主键字段列表<span class="token punctuation">)</span><span class="token comment">#如果是复合主键，那么就需要在所有字段列表后面使用这种形式指定，不能在字段后面直接加primary key</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（2）如何在建表后指定主键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">add</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>主键字段列表<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>（3）如何删除主键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">drop</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="4、唯一键约束：unique-key"><a href="#4、唯一键约束：unique-key" class="headerlink" title="4、唯一键约束：unique key"></a>4、唯一键约束：unique key</h3><p>（1）唯一键约束特点</p>
<ul>
<li><p>唯一键约束列允许为null。</p>
</li>
<li><p>同一个表可以有多个唯一约束。</p>
</li>
<li><p>唯一约束可以是某一个列的值唯一，也可以多个列组合值的唯一。</p>
</li>
<li><p>MySQL会给唯一约束的列上默认创建一个唯一索引。</p>
</li>
</ul>
<ul>
<li>删除唯一键只能通过删除对应索引的方式删除，删除时需要指定唯一键索引名</li>
</ul>
<p>（2）如何在建表时指定唯一键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
	字段名<span class="token number">2</span> 数据类型 <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
    字段名<span class="token number">1</span> 数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
    字段名<span class="token number">2</span> 数据类型<span class="token punctuation">,</span>
    字段名<span class="token number">3</span> 数据类型<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>复合唯一字段列表<span class="token punctuation">)</span><span class="token comment">#如果是复合唯一键，那么就需要在所有字段列表后面使用这种形式指定，不能在字段后面直接加unique key</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（3）如何在建表后增加唯一键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">add</span> 【<span class="token keyword">constraint</span> 约束名】 <span class="token keyword">unique</span> 【<span class="token keyword">key</span>】 <span class="token punctuation">(</span>字段名列表<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#如果没有指定约束名，(字段名列表)中只有一个字段的，默认是该字段名，如果是多个字段的默认是字段名列表的第1个字段名。也可以通过show index from 表名;来查看</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>（4）如何删除唯一键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> 唯一性约束名<span class="token punctuation">;</span>
<span class="token comment">#注意：如果忘记名称，可以通过“show index from 表名称;”查看</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="5、非空约束：not-null"><a href="#5、非空约束：not-null" class="headerlink" title="5、非空约束：not null"></a>5、非空约束：not null</h3><p>NOT NULL 非空约束，规定某个字段不能为空</p>
<p>（1）如何在建表时给某个字段指定非空约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
	字段名<span class="token number">2</span> 数据类型 【<span class="token keyword">unique</span> <span class="token keyword">key</span>】 【<span class="token operator">not</span> <span class="token boolean">null</span>】<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>从表字段<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>主表字段<span class="token punctuation">)</span> 【<span class="token keyword">on</span> <span class="token keyword">update</span> 外键约束等级】【<span class="token keyword">on</span> <span class="token keyword">delete</span> 外键约束等级【
    <span class="token comment">#外键只能在所有字段列表后面单独指定</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
    字段名<span class="token number">1</span> 数据类型 【<span class="token operator">not</span> <span class="token boolean">null</span>】<span class="token punctuation">,</span>
    字段名<span class="token number">2</span> 数据类型 【<span class="token operator">not</span> <span class="token boolean">null</span>】<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>复合主键字段列表<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#如果是复合主键，那么就需要在所有字段列表后面使用这种形式指定，不能在字段后面直接加primary key</span>
    <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>复合唯一字段列表<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#如果是复合唯一键，那么就需要在所有字段列表后面使用这种形式指定，不能在字段后面直接加unique key</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>从表字段<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>主表字段<span class="token punctuation">)</span> 【<span class="token keyword">on</span> <span class="token keyword">update</span> 外键约束等级】【<span class="token keyword">on</span> <span class="token keyword">delete</span> 外键约束等级【
    <span class="token comment">#外键只能在所有字段列表后面单独指定</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（2）如何在建表后指定某个字段非空</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">MODIFY</span> 字段名 数据类型 <span class="token operator">NOT</span> <span class="token boolean">NULL</span> 【<span class="token keyword">default</span> 默认值】<span class="token punctuation">;</span>
<span class="token comment">#如果该字段原来设置了默认值约束，要跟着一起再写一遍，否则默认值约束会丢失</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>（3）如何在建表后取消某个字段非空</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">MODIFY</span> 字段名 数据类型 【<span class="token keyword">default</span> 默认值】<span class="token punctuation">;</span>
<span class="token comment">#如果该字段原来设置了默认值约束，要跟着一起再写一遍，否则默认值约束会丢失</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="6、默认值约束：default"><a href="#6、默认值约束：default" class="headerlink" title="6、默认值约束：default"></a>6、默认值约束：default</h3><p>（1）如何在建表时给某个字段指定默认约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
	字段名<span class="token number">2</span> 数据类型 【<span class="token keyword">unique</span> <span class="token keyword">key</span>】 【<span class="token operator">not</span> <span class="token boolean">null</span>】 【<span class="token keyword">default</span> 默认值】<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>从表字段<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>主表字段<span class="token punctuation">)</span> 【<span class="token keyword">on</span> <span class="token keyword">update</span> 外键约束等级】【<span class="token keyword">on</span> <span class="token keyword">delete</span> 外键约束等级【
    <span class="token comment">#外键只能在所有字段列表后面单独指定</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
    字段名<span class="token number">1</span> 数据类型 【<span class="token operator">not</span> <span class="token boolean">null</span>】 【<span class="token keyword">default</span> 默认值】<span class="token punctuation">,</span>
    字段名<span class="token number">2</span> 数据类型 【<span class="token operator">not</span> <span class="token boolean">null</span>】 【<span class="token keyword">default</span> 默认值】<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>复合主键字段列表<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#如果是复合主键，那么就需要在所有字段列表后面使用这种形式指定，不能在字段后面直接加primary key</span>
    <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>复合唯一字段列表<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#如果是复合唯一键，那么就需要在所有字段列表后面使用这种形式指定，不能在字段后面直接加unique key</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>从表字段<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>主表字段<span class="token punctuation">)</span> 【<span class="token keyword">on</span> <span class="token keyword">update</span> 外键约束等级】【<span class="token keyword">on</span> <span class="token keyword">delete</span> 外键约束等级【
    <span class="token comment">#外键只能在所有字段列表后面单独指定</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（2）如何在建表后指定某个字段的默认值约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">MODIFY</span> 字段名 数据类型  【<span class="token keyword">default</span> 默认值】 【<span class="token operator">NOT</span> <span class="token boolean">NULL</span>】<span class="token punctuation">;</span>
<span class="token comment">#如果该字段原来设置了非空约束，要跟着一起再写一遍，否则非空约束会丢失</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>（3）如何在建表后取消某个字段的默认值约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">MODIFY</span> 字段名 数据类型 【<span class="token operator">NOT</span> <span class="token boolean">NULL</span>】<span class="token punctuation">;</span>
<span class="token comment">#如果该字段原来设置了非空约束，要跟着一起再写一遍，否则非空约束会丢失</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="7、检查约束：check"><a href="#7、检查约束：check" class="headerlink" title="7、检查约束：check"></a>7、检查约束：check</h3><p>检查约束，mysql暂不支持</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> stu<span class="token punctuation">(</span>
	sid <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
	sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	gender <span class="token keyword">char</span> <span class="token keyword">check</span> <span class="token punctuation">(</span><span class="token string">'男'</span><span class="token operator">or</span><span class="token string">'女'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stu <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stu <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'妖'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

使用枚举类型解决如上问题：
<span class="token keyword">create</span> <span class="token keyword">table</span> stu<span class="token punctuation">(</span>
	sid <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
	sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	gender <span class="token keyword">enum</span> <span class="token punctuation">(</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="8、自增约束：auto-increment"><a href="#8、自增约束：auto-increment" class="headerlink" title="8、自增约束：auto_increment"></a>8、自增约束：auto_increment</h3><p>（1）关于自增长auto_increment：</p>
<ul>
<li>一个表最多只能有一个自增长列</li>
<li>自增长列必须是键列（主键列，唯一键列，外键列），并且要求非空。</li>
<li>自增列必须是整数类型</li>
<li>InnoDB表的自动增长列可以手动插入，但是插入的值如果是空或者0，则实际插入的将是自动增长后的值。</li>
</ul>
<p>（2）如何在建表时指定自增长列</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	字段名<span class="token number">2</span> 数据类型 【<span class="token keyword">unique</span> <span class="token keyword">key</span>】 【<span class="token operator">not</span> <span class="token boolean">null</span>】 【<span class="token keyword">default</span> 默认值】<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

或
<span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
	字段名<span class="token number">2</span> 数据类型 【<span class="token keyword">unique</span> <span class="token keyword">key</span>  <span class="token operator">not</span> <span class="token boolean">null</span>】 <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（3）如何在建表后指定自增长列</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名 <span class="token keyword">modify</span> 自增字段名 数据类型 <span class="token keyword">auto_increment</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>（4）如何删除自增约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名 <span class="token keyword">modify</span> 自增字段名 数据类型<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="9、外键约束：foreign-key"><a href="#9、外键约束：foreign-key" class="headerlink" title="9、外键约束：foreign key"></a>9、外键约束：foreign key</h3><p>外键约束（FOREIGN KEY，缩写FK）是用来实现数据库表的参照完整性的。外键约束可以使两张表紧密的结合起来，特别是针对修改或者删除的级联操作时，会保证数据的完整性。</p>
<p>外键是指表中某个字段的值依赖于另一张表中某个字段的值，而<em><strong>被依赖的字段必须具有主键约束或者唯一约束</strong></em>。被依赖的表我们通常称之为父表或者主表，设置外键约束的表称为子表或者从表。</p>
<p>举个例子：如果想要表示学生和班级的关系，首先要有学生表和班级表两张表，然后学生表中有个字段为stu_clazz（该字段表示学生所在的班级），而该字段的取值范围由班级表中的主键cla_no字段（该字段表示班级编号）的取值决定。那么班级表为主表，学生表为从表，且stu_clazz字段是学生表的外键。通过stu_clazz字段就建立了学生表和班级表的关系。</p>
<p><img src="http://imag.fun-ny.cn/img/wps111.jpg" alt="img"></p>
<p>（1）外键特点</p>
<ul>
<li><p>外键约束是保证一个或两个表之间的参照完整性,外键是构建于一个表的两个字段或是两个表的两个字段之间的参照关系。</p>
</li>
<li><p>在创建外键约束时，如果不给外键约束名称，默认名不是列名，而是自动产生一个外键名（例如 student_ibfk_1;），也可以指定外键约束名。</p>
</li>
<li><p>当创建外键约束时，系统默认会在所在的列上建立对应的普通索引。但是索引名是列名，不是外键的约束名。</p>
</li>
<li><p>删除外键时，关于外键列上的普通索引需要单独删除。</p>
</li>
</ul>
<p>（2）要求</p>
<ul>
<li><p>在从表上建立外键，而且主表要先存在。</p>
</li>
<li><p>一个表可以建立多个外键约束</p>
</li>
<li><p>从表的外键列，在主表中引用的只能是键列（主键，唯一键，外键），推荐引用主表的主键。</p>
</li>
<li><p>从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样</p>
</li>
</ul>
<p>（3）约束关系：约束是针对双方的</p>
<ul>
<li><p>添加了外键约束后，主表的修改和删除数据受约束</p>
</li>
<li><p>添加了外键约束后，从表的添加和修改数据受约束</p>
</li>
<li><p>在从表上建立外键，要求主表必须存在</p>
</li>
<li><p>删除主表时，要求从表从表先删除，或将从表中外键引用该主表的关系先删除</p>
</li>
</ul>
<p>（4）5个约束等级</p>
<ul>
<li><p>Cascade方式：在父表上update/delete记录时，同步update/delete掉子表的匹配记录 </p>
</li>
<li><p>Set null方式：在父表上update/delete记录时，将子表上匹配记录的列设为null，但是要注意子表的外键列不能为not null  </p>
</li>
<li><p>No action方式：如果子表中有匹配的记录,则不允许对父表对应候选键进行update/delete操作  </p>
</li>
<li><p>Restrict方式：同no action, 都是立即检查外键约束</p>
</li>
<li><p>Set default方式（在可视化工具SQLyog中可能显示空白）：父表有变更时,子表将外键列设置成一个默认的值，但Innodb不能识别</p>
</li>
</ul>
<p>如果没有指定等级，就相当于Restrict方式</p>
<p>（5）如何在建表时指定外键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】从表名<span class="token punctuation">(</span>
	字段名<span class="token number">1</span> 数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
	字段名<span class="token number">2</span> 数据类型 【<span class="token keyword">unique</span> <span class="token keyword">key</span>】<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    【<span class="token keyword">constraint</span> 外键约束名】 <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>从表字段<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>主表字段<span class="token punctuation">)</span> 【<span class="token keyword">on</span> <span class="token keyword">update</span> 外键约束等级】【<span class="token keyword">on</span> <span class="token keyword">delete</span> 外键约束等级【
    <span class="token comment">#外键只能在所有字段列表后面单独指定</span>
    <span class="token comment">#如果要自己命名外键约束名，建议 主表名_从表名_关联字段名_fk</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> 【数据名<span class="token punctuation">.</span>】表名<span class="token punctuation">(</span>
    字段名<span class="token number">1</span> 数据类型<span class="token punctuation">,</span>
    字段名<span class="token number">2</span> 数据类型<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>复合主键字段列表<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#如果是复合主键，那么就需要在所有字段列表后面使用这种形式指定，不能在字段后面直接加primary key</span>
    <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>复合唯一字段列表<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#如果是复合唯一键，那么就需要在所有字段列表后面使用这种形式指定，不能在字段后面直接加unique key</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>从表字段<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>主表字段<span class="token punctuation">)</span> 【<span class="token keyword">on</span> <span class="token keyword">update</span> 外键约束等级】【<span class="token keyword">on</span> <span class="token keyword">delete</span> 外键约束等级【
    <span class="token comment">#外键只能在所有字段列表后面单独指定</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（6）如何在建表后指定外键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 从表名称 <span class="token keyword">add</span> 【<span class="token keyword">constraint</span> 外键约束名】 <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>从表字段名<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>主表被参照字段名<span class="token punctuation">)</span> 【<span class="token keyword">on</span> <span class="token keyword">update</span> xx】<span class="token punctuation">[</span><span class="token keyword">on</span> <span class="token keyword">delete</span> xx<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>（7）如何删除外键约束</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> 外键约束名<span class="token punctuation">;</span>
<span class="token comment">#查看约束名 SELECT * FROM information_schema.table_constraints WHERE table_name = '表名称';</span>
<span class="token comment">#删除外键约束不会删除对应的索引，如果需要删除索引，需要用ALTER TABLE 表名称 DROP INDEX 索引名;</span>
<span class="token comment">#查看索引名 show index from 表名称;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="4-3-DML-v2-0"><a href="#4-3-DML-v2-0" class="headerlink" title="4.3 DML(v2.0)"></a>4.3 DML(v2.0)</h2><p>1、如果某列有自增约束，怎么添加该字段的值</p>
<p>添加数据时，对于自增列</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">values</span><span class="token punctuation">(</span>值列表<span class="token punctuation">)</span>；<span class="token comment">#在值列表中，对应自增列可以赋值为null和0</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">(</span>部分字段列表<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>值列表<span class="token punctuation">)</span>；<span class="token comment">#自增列在(部分字段列表)中不写就可以</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>2、如果某列有默认值约束，怎么添加、修改该字段的值</p>
<p>添加数据时，对于有默认值列</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">values</span><span class="token punctuation">(</span>值列表<span class="token punctuation">)</span>；<span class="token comment">#在值列表中，对应默认值列，如果想用默认值，用default</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称<span class="token punctuation">(</span>部分字段列表<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>值列表<span class="token punctuation">)</span>；<span class="token comment">#对应默认值列，如果想用默认值，在(部分字段列表)中不写就可以</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>修改数据</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> 【数据库名<span class="token punctuation">.</span><span class="token punctuation">]</span>表名称 <span class="token keyword">set</span> 字段名<span class="token number">1</span> <span class="token operator">=</span> 值<span class="token number">1</span><span class="token punctuation">,</span> 字段名<span class="token number">2</span> <span class="token operator">=</span> 值<span class="token number">2</span> 。。。 【<span class="token keyword">where</span> 条件】<span class="token punctuation">;</span> <span class="token comment">#对应默认值列，如果想用默认值，写字段名 = default就可以</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h1 id="5-函数"><a href="#5-函数" class="headerlink" title="5 函数"></a>5 函数</h1><p><strong>两种SQL函数</strong></p>
<p><img src="http://imag.fun-ny.cn/img/1557457787630.png" alt="1557457787630"></p>
<h2 id="5-1单行函数"><a href="#5-1单行函数" class="headerlink" title="5.1单行函数"></a>5.1单行函数</h2><ul>
<li><strong>只对一行进行变换，每行返回一个结果</strong></li>
<li>可以嵌套</li>
<li>参数可以是一字段或一个表达式或一个值</li>
</ul>
<h3 id="5-1-1-字符串函数"><a href="#5-1-1-字符串函数" class="headerlink" title="5.1.1 字符串函数"></a>5.1.1 字符串函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>CONCAT(S1,S2,……,Sn)</td>
<td>连接S1,S2,……,Sn为一个字符串</td>
</tr>
<tr>
<td>CONCAT_WS(s, S1,S2,……,Sn)</td>
<td>同CONCAT(s1,s2,…)函数，但是每个字符串之间要加上s</td>
</tr>
<tr>
<td>CHAR_LENGTH(s)</td>
<td>返回字符串s的字符数</td>
</tr>
<tr>
<td>LENGTH(s)</td>
<td>返回字符串s的字节数，和字符集有关</td>
</tr>
<tr>
<td>INSERT(str, index , len, instr)</td>
<td>将字符串str从第index位置开始，len个字符长的子串替换为字符串instr</td>
</tr>
<tr>
<td>UPPER(s) 或 UCASE(s)</td>
<td>将字符串s的所有字母转成大写字母</td>
</tr>
<tr>
<td>LOWER(s)  或LCASE(s)</td>
<td>将字符串s的所有字母转成小写字母</td>
</tr>
<tr>
<td>LEFT(s,n)</td>
<td>返回字符串s最左边的n个字符</td>
</tr>
<tr>
<td>RIGHT(s,n)</td>
<td>返回字符串s最右边的n个字符</td>
</tr>
<tr>
<td>LPAD(str, len, pad)</td>
<td>用字符串pad对str最左边进行填充，直到str的长度为len个字符</td>
</tr>
<tr>
<td>RPAD(str ,len, pad)</td>
<td>用字符串pad对str最右边进行填充，直到str的长度为len个字符</td>
</tr>
<tr>
<td>LTRIM(s)</td>
<td>去掉字符串s左侧的空格</td>
</tr>
<tr>
<td>RTRIM(s)</td>
<td>去掉字符串s右侧的空格</td>
</tr>
<tr>
<td>TRIM(s)</td>
<td>去掉字符串s开始与结尾的空格</td>
</tr>
<tr>
<td>TRIM(【BOTH 】s1 FROM s)</td>
<td>去掉字符串s开始与结尾的s1</td>
</tr>
<tr>
<td>TRIM(【LEADING】s1 FROM s)</td>
<td>去掉字符串s开始处的s1</td>
</tr>
<tr>
<td>TRIM(【TRAILING】s1 FROM s)</td>
<td>去掉字符串s结尾处的s1</td>
</tr>
<tr>
<td>REPEAT(str, n)</td>
<td>返回str重复n次的结果</td>
</tr>
<tr>
<td>REPLACE（str, a, b）</td>
<td>用字符串b替换字符串str中所有出现的字符串a</td>
</tr>
<tr>
<td>STRCMP(s1,s2)</td>
<td>比较字符串s1,s2</td>
</tr>
<tr>
<td>SUBSTRING(s,index,len)</td>
<td>返回从字符串s的index位置其len个字符</td>
</tr>
</tbody></table>
<ul>
<li><strong>举例1：大小写控制函数</strong></li>
</ul>
<table>
<thead>
<tr>
<th>函数</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td><strong>LOWER(‘SQL Course’)</strong></td>
<td><strong>sql course</strong></td>
</tr>
<tr>
<td><strong>UPPER(‘SQL Course’)</strong></td>
<td><strong>SQL COURSE</strong></td>
</tr>
</tbody></table>
<blockquote>
<p>这类函数改变字符的大小写。</p>
</blockquote>
<ul>
<li><strong>举例2：字符控制函数</strong></li>
</ul>
<table>
<thead>
<tr>
<th>函数</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td><strong>CONCAT(‘Hello’,’World’)</strong></td>
<td><strong>HelloWorld</strong></td>
</tr>
<tr>
<td><strong>SUBSTR(‘HelloWorld’,1,5)</strong></td>
<td><strong>Hello</strong></td>
</tr>
<tr>
<td><strong>LENGTH(‘HelloWorld’)</strong></td>
<td><strong>10</strong></td>
</tr>
<tr>
<td><strong>INSTR(‘HelloWorld’,’W’)</strong></td>
<td><strong>6</strong></td>
</tr>
<tr>
<td><strong>LPAD(salary,10,’*‘)</strong></td>
<td><strong>*****24000</strong></td>
</tr>
<tr>
<td><strong>RPAD(salary,10, ‘*‘)</strong></td>
<td><strong>24000*<em>*</em>***</strong></td>
</tr>
<tr>
<td><strong>TRIM(‘H’ FROM ‘HelloWorld’)</strong></td>
<td><strong>elloWorld</strong></td>
</tr>
<tr>
<td><strong>REPLACE(‘abcd’,’b’,’m’)</strong></td>
<td><strong>amcd</strong></td>
</tr>
</tbody></table>
<h3 id="5-1-2-数值函数-数学函数"><a href="#5-1-2-数值函数-数学函数" class="headerlink" title="5.1.2 数值函数/数学函数"></a>5.1.2 数值函数/数学函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>ABS(x)</td>
<td>返回x的绝对值</td>
</tr>
<tr>
<td>CEIL(x)</td>
<td>返回大于x的最小整数值</td>
</tr>
<tr>
<td>FLOOR(x)</td>
<td>返回小于x的最大整数值</td>
</tr>
<tr>
<td>MOD(x,y)</td>
<td>返回x/y的模</td>
</tr>
<tr>
<td>RAND()</td>
<td>返回0~1的随机值</td>
</tr>
<tr>
<td>ROUND(x,y)</td>
<td>返回参数x的四舍五入的有y位的小数的值</td>
</tr>
<tr>
<td>TRUNCATE(x,y)</td>
<td>返回数字x截断为y位小数的结果</td>
</tr>
<tr>
<td>SQRT(x)</td>
<td>返回x的平方根</td>
</tr>
<tr>
<td>POW(x,y)</td>
<td>返回x的y次方</td>
</tr>
</tbody></table>
<ul>
<li><strong>举例1：ROUND:四舍五入</strong></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">ROUND(45.926, 2)     --&gt;  45.93<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>举例2：TRUNCATE:截断</strong></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">TRUNCATE(45.926)      --&gt; 45<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>举例3：MOD:求余</strong></li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token function">MOD</span><span class="token punctuation">(</span><span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>	 <span class="token comment">--&gt; 100</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h3 id="5-1-3-日期函数"><a href="#5-1-3-日期函数" class="headerlink" title="5.1.3 日期函数"></a>5.1.3 日期函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td><strong>CURDATE()</strong> 或 CURRENT_DATE()</td>
<td>返回当前日期</td>
</tr>
<tr>
<td><strong>CURTIME()</strong> 或 CURRENT_TIME()</td>
<td>返回当前时间</td>
</tr>
<tr>
<td><strong>NOW()</strong> / SYSDATE() / CURRENT_TIMESTAMP() / LOCALTIME() / LOCALTIMESTAMP()</td>
<td>返回当前系统日期时间</td>
</tr>
<tr>
<td><strong>YEAR(date) / MONTH(date) / DAY(date) / HOUR(time) / MINUTE(time) / SECOND(time)</strong></td>
<td>返回具体的时间值</td>
</tr>
<tr>
<td>WEEK(date) / WEEKOFYEAR(date)</td>
<td>返回一年中的第几周</td>
</tr>
<tr>
<td>DAYOFWEEK()</td>
<td>返回周几，注意：周日是1，周一是2，。。。周六是7</td>
</tr>
<tr>
<td>WEEKDAY(date)</td>
<td>返回周几，注意，周1是0，周2是1，。。。周日是6</td>
</tr>
<tr>
<td>DAYNAME(date)</td>
<td>返回星期：MONDAY,TUESDAY…..SUNDAY</td>
</tr>
<tr>
<td>MONTHNAME(date)</td>
<td>返回月份：January，。。。。。</td>
</tr>
<tr>
<td>DATEDIFF(date1,date2) / TIMEDIFF(time1, time2)</td>
<td>返回date1 - date2的日期间隔 / 返回time1 - time2的时间间隔</td>
</tr>
<tr>
<td>DATE_ADD(datetime, INTERVAL  expr type)</td>
<td>返回与给定日期时间相差INTERVAL时间段的日期时间</td>
</tr>
<tr>
<td>DATE_FORMAT(datetime ,fmt)</td>
<td>按照字符串fmt格式化日期datetime值</td>
</tr>
<tr>
<td>STR_TO_DATE(str, fmt)</td>
<td>按照字符串fmt对str进行解析，解析为一个日期</td>
</tr>
</tbody></table>
<p>其中：</p>
<p><strong>（1）DATE_ADD(datetime,INTERVAL  expr type)</strong></p>
<p>表达式类型：</p>
<table>
<thead>
<tr>
<th>参数类型</th>
<th>参数类型</th>
</tr>
</thead>
<tbody><tr>
<td>YEAR</td>
<td>YEAR_MONTH</td>
</tr>
<tr>
<td>MONTH</td>
<td>DAY_HOUR</td>
</tr>
<tr>
<td>DAY</td>
<td>DAY_MINUTE</td>
</tr>
<tr>
<td>HOUR</td>
<td>DAY_SECOND</td>
</tr>
<tr>
<td>MINUTE</td>
<td>HOUR_MINUTE</td>
</tr>
<tr>
<td>SECOND</td>
<td>HOUR_SECOND</td>
</tr>
<tr>
<td></td>
<td>MINUTE_SECOND</td>
</tr>
</tbody></table>
<p>举例：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> DATE_ADD<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">YEAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> DATE_ADD<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">YEAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">#可以是负数</span>
<span class="token keyword">SELECT</span> DATE_ADD<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token string">'1_1'</span> YEAR_MONTH<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">#需要单引号</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>（2）DATE_FORMAT(datetime,fmt) 和 STR_TO_DATE(str, fmt)</strong></p>
<table>
<thead>
<tr>
<th>格式符</th>
<th>说明</th>
<th>格式符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>%Y</td>
<td>4位数字表示年份</td>
<td>%y</td>
<td>表示两位数字表示年份</td>
</tr>
<tr>
<td>%M</td>
<td>月名表示月份（January,….）</td>
<td>%m</td>
<td>两位数字表示月份（01,02,03。。。）</td>
</tr>
<tr>
<td>%b</td>
<td>缩写的月名（Jan.，Feb.，….）</td>
<td>%c</td>
<td>数字表示月份（1,2,3,…）</td>
</tr>
<tr>
<td>%D</td>
<td>英文后缀表示月中的天数（1st,2nd,3rd,…）</td>
<td>%d</td>
<td>两位数字表示月中的天数(01,02…)</td>
</tr>
<tr>
<td>%e</td>
<td>数字形式表示月中的天数（1,2,3,4,5…..）</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%H</td>
<td>两位数字表示小数，24小时制（01,02..）</td>
<td>%h和%I</td>
<td>两位数字表示小时，12小时制（01,02..）</td>
</tr>
<tr>
<td>%k</td>
<td>数字形式的小时，24小时制(1,2,3)</td>
<td>%l</td>
<td>数字形式表示小时，12小时制（1,2,3,4….）</td>
</tr>
<tr>
<td>%i</td>
<td>两位数字表示分钟（00,01,02）</td>
<td>%S和%s</td>
<td>两位数字表示秒(00,01,02…)</td>
</tr>
<tr>
<td>%W</td>
<td>一周中的星期名称（Sunday…）</td>
<td>%a</td>
<td>一周中的星期缩写（Sun.，Mon.,Tues.，..）</td>
</tr>
<tr>
<td>%w</td>
<td>以数字表示周中的天数(0=Sunday,1=Monday….)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%j</td>
<td>以3位数字表示年中的天数(001,002…)</td>
<td>%U</td>
<td>以数字表示年中的第几周，（1,2,3。。）其中Sunday为周中第一天</td>
</tr>
<tr>
<td>%u</td>
<td>以数字表示年中的第几周，（1,2,3。。）其中Monday为周中第一天</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%T</td>
<td>24小时制</td>
<td>%r</td>
<td>12小时制</td>
</tr>
<tr>
<td>%p</td>
<td>AM或PM</td>
<td>%%</td>
<td>表示%</td>
</tr>
</tbody></table>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y %m %D %H %i %s'</span><span class="token punctuation">)</span>
                         <span class="token number">2020</span> <span class="token number">09</span> <span class="token number">8</span>th <span class="token number">13</span> <span class="token number">56</span> <span class="token number">51</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> str_to_date<span class="token punctuation">(</span><span class="token string">'2020-9-9'</span><span class="token punctuation">,</span> <span class="token string">"%Y-%m-%D"</span><span class="token punctuation">)</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">09</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h3 id="5-1-4-流程函数"><a href="#5-1-4-流程函数" class="headerlink" title="5.1.4 流程函数"></a>5.1.4 流程函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>IF(value,t ,f)</td>
<td>如果value是真，返回t，否则返回f</td>
</tr>
<tr>
<td>IFNULL(value1, value2)</td>
<td>如果value1不为空，返回value1，否则返回value2</td>
</tr>
<tr>
<td>CASE WHEN 条件1 THEN result1 WHEN 条件2 THEN result2 …. [ELSE resultn] END</td>
<td>相当于Java的if…else if…else…</td>
</tr>
<tr>
<td>CASE  expr WHEN 常量值1 THEN 值1 WHEN 常量值1 THEN 值1 …. [ELSE 值n] END</td>
<td>相当于Java的switch…case…</td>
</tr>
</tbody></table>
<ul>
<li>举例1：</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span><span class="token number">12</span> <span class="token operator">*</span> salary <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">"年薪"</span>
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>举例2：</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span> job_id<span class="token punctuation">,</span> salary<span class="token punctuation">,</span>
       <span class="token keyword">CASE</span> job_id <span class="token keyword">WHEN</span> <span class="token string">'IT_PROG'</span>  <span class="token keyword">THEN</span>  <span class="token number">1.10</span><span class="token operator">*</span>salary
                   <span class="token keyword">WHEN</span> <span class="token string">'ST_CLERK'</span> <span class="token keyword">THEN</span>  <span class="token number">1.15</span><span class="token operator">*</span>salary
                   <span class="token keyword">WHEN</span> <span class="token string">'SA_REP'</span>   <span class="token keyword">THEN</span>  <span class="token number">1.20</span><span class="token operator">*</span>salary
       <span class="token keyword">ELSE</span>      salary <span class="token keyword">END</span>     <span class="token string">"实发工资"</span>
<span class="token keyword">FROM</span>   employees<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>举例3：</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">SELECT employee_id,salary, CASE WHEN salary&gt;=15000 THEN '高薪' 
				  WHEN salary&gt;=10000 THEN '潜力股'  
				  WHEN salary&gt;=8000 THEN '屌丝' 
				  ELSE '草根' END  "描述"
FROM employees; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-1-5-其他函数"><a href="#5-1-5-其他函数" class="headerlink" title="5.1.5 其他函数"></a>5.1.5 其他函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>database()</td>
<td>返回当前数据库名</td>
</tr>
<tr>
<td>version()</td>
<td>返回当前数据库版本</td>
</tr>
<tr>
<td>user()</td>
<td>返回当前登录用户名</td>
</tr>
<tr>
<td>password(str)</td>
<td>返回字符串str的加密版本，41位长的字符串</td>
</tr>
<tr>
<td>md5(str)</td>
<td>返回字符串str的md5值，也是一种加密方式</td>
</tr>
</tbody></table>
<h2 id="5-2多行（分组）函数"><a href="#5-2多行（分组）函数" class="headerlink" title="5.2多行（分组）函数"></a>5.2多行（分组）函数</h2><ul>
<li><strong>什么是分组函数</strong></li>
</ul>
<p>对一组数据进行运算，针对一组数据（多行记录）只返回一个结果，也称分组函数。</p>
<p><img src="http://imag.fun-ny.cn/img/1557457823209.png" alt="1557457823209"></p>
<ul>
<li><strong>组函数类型</strong><ul>
<li><strong>AVG()</strong> </li>
<li><strong>SUM()</strong></li>
<li><strong>MAX()</strong> </li>
<li><strong>MIN()</strong> </li>
<li>**COUNT() **</li>
</ul>
</li>
</ul>
<p>可以对<strong>数值型数据</strong>使用AVG 和 SUM 函数。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>   employees
<span class="token keyword">WHERE</span>  job_id <span class="token operator">LIKE</span> <span class="token string">'%REP%'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>可以对<strong>任意数据类型</strong>的数据使用 MIN 和 MAX 函数。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>hire_date<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>hire_date<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>	  employees<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>COUNT(*)count(1返回表中记录总数,适用于<strong>任意数据类型</strong>。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span>	  employees
<span class="token keyword">WHERE</span>  department_id <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>•COUNT(expr) 返回<strong>expr不为空</strong>的记录总数。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>   employees
<span class="token keyword">WHERE</span>  department_id <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>问题：用count(*)，count(1)谁好呢?</p>
<p>其实，对于myisam引擎的表是没有区别的。这种引擎内部有一计数器在维护着行数。</p>
<p>Innodb引擎的表用count(*)直接读行数，效率很低，因为innodb真的要去数一遍。</p>
</li>
</ul>
<h1 id="6-关联查询（联合查询-多表联查）"><a href="#6-关联查询（联合查询-多表联查）" class="headerlink" title="6 关联查询（联合查询,多表联查）"></a>6 关联查询（联合查询,多表联查）</h1><h2 id="6-1-关联查询的七种结果"><a href="#6-1-关联查询的七种结果" class="headerlink" title="6.1 关联查询的七种结果"></a>6.1 关联查询的七种结果</h2><p><img src="http://imag.fun-ny.cn/img/1557194340352.png" alt="1557194340352"></p>
<p>（1）A∩B</p>
<p>（2）A</p>
<p>（3）A -  A∩B</p>
<p>（4）B</p>
<p>（5）B - A∩B</p>
<p>（6）A ∪ B</p>
<p>（7）A∪B- A∩B    或者   (A -  A∩B) ∪ （B - A∩B）</p>
<h2 id="6-2-如何实现？"><a href="#6-2-如何实现？" class="headerlink" title="6.2 如何实现？"></a>6.2 如何实现？</h2><p>（1）内连接</p>
<p>（2）外连接：左外连接、右外连接、全外连接（mysql使用union代替全外连接）</p>
<h3 id="1、内连接：实现A∩B"><a href="#1、内连接：实现A∩B" class="headerlink" title="1、内连接：实现A∩B"></a>1、内连接：实现A∩B</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">inner</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 等其他子句<span class="token punctuation">;</span>

或

<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token punctuation">,</span> B表
<span class="token keyword">where</span> 关联条件 <span class="token operator">and</span> 等其他子句<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>代码示例：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询员工的姓名和他所在的部门的名称</span>
<span class="token comment">#员工的姓名在t_employee</span>
<span class="token comment">#部门的名称在t_department</span>
<span class="token keyword">SELECT</span> ename <span class="token string">"员工的姓名"</span><span class="token punctuation">,</span>dname <span class="token string">"部门名称"</span>
<span class="token keyword">FROM</span> t_employee <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did

<span class="token keyword">SELECT</span> ename <span class="token string">"员工的姓名"</span><span class="token punctuation">,</span>dname <span class="token string">"部门名称"</span>
<span class="token keyword">FROM</span> t_employee <span class="token punctuation">,</span> t_department
<span class="token keyword">WHERE</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did


<span class="token comment">#查询薪资高于20000的男员工的姓名和他所在的部门的名称</span>
<span class="token keyword">SELECT</span> ename <span class="token string">"员工的姓名"</span><span class="token punctuation">,</span>dname <span class="token string">"部门名称"</span>
<span class="token keyword">FROM</span> t_employee <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did
<span class="token keyword">WHERE</span> salary<span class="token operator">&gt;</span><span class="token number">20000</span> <span class="token operator">AND</span> gender <span class="token operator">=</span> <span class="token string">'男'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="2、左外连接"><a href="#2、左外连接" class="headerlink" title="2、左外连接"></a>2、左外连接</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#实现查询结果是A</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">left</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 等其他子句<span class="token punctuation">;</span>

<span class="token comment">#实现A -  A∩B</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">left</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 从表关联字段 <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> 等其他子句<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>代码示例：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询所有员工的姓名和他所在的部门的名称</span>
<span class="token keyword">SELECT</span> ename <span class="token string">"员工的姓名"</span><span class="token punctuation">,</span>dname <span class="token string">"部门名称"</span>
<span class="token keyword">FROM</span> t_employee <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did


<span class="token comment">#查询所有没有部门的员工</span>
<span class="token keyword">SELECT</span> ename <span class="token string">"员工的姓名"</span><span class="token punctuation">,</span>dname <span class="token string">"部门名称"</span>
<span class="token keyword">FROM</span> t_employee <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did
<span class="token keyword">WHERE</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">IS</span> <span class="token boolean">NULL</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="3、右外连接"><a href="#3、右外连接" class="headerlink" title="3、右外连接"></a>3、右外连接</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#实现查询结果是B</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">right</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 等其他子句<span class="token punctuation">;</span>

<span class="token comment">#实现B -  A∩B</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">right</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 从表关联字段 <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> 等其他子句<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>代码示例：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询所有部门，以及所有部门下的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> t_employee <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did

<span class="token comment">#查询那些没有员工属于它的部门</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> t_employee <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did
<span class="token keyword">WHERE</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">IS</span> <span class="token boolean">NULL</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="4、用union代替全外连接"><a href="#4、用union代替全外连接" class="headerlink" title="4、用union代替全外连接"></a>4、用union代替全外连接</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#实现查询结果是A∪B</span>
<span class="token comment">#用左外的A，union 右外的B</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">left</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 等其他子句

<span class="token keyword">union</span> 

<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">right</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 等其他子句<span class="token punctuation">;</span>



<span class="token comment">#实现A∪B -  A∩B  或   (A -  A∩B) ∪ （B - A∩B）</span>
<span class="token comment">#使用左外的 (A -  A∩B)  union 右外的（B - A∩B）</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">left</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 从表关联字段 <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> 等其他子句

<span class="token keyword">union</span>

<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">right</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 从表关联字段 <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> 等其他子句<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>代码示例：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询所有员工，所有部门，包括没有员工的部门，和没有部门的员工</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> t_employee <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did

<span class="token keyword">UNION</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> t_employee <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did


<span class="token comment">#查询那些没有部门的员工和所有没有员工的部门</span>

<span class="token comment">#没有部门的员工</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> t_employee <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did
<span class="token keyword">WHERE</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">IS</span> <span class="token boolean">NULL</span>

<span class="token keyword">UNION</span> 

<span class="token comment">#所有没有员工的部门</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> t_employee <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> t_department
<span class="token keyword">ON</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">=</span> t_department<span class="token punctuation">.</span>did
<span class="token keyword">WHERE</span> t_employee<span class="token punctuation">.</span>did <span class="token operator">IS</span> <span class="token boolean">NULL</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="6-3-特殊的关联查询：自连接"><a href="#6-3-特殊的关联查询：自连接" class="headerlink" title="6.3 特殊的关联查询：自连接"></a>6.3 特殊的关联查询：自连接</h2><p>两个关联查询的表是同一张表，通过取别名的方式来虚拟成两张表</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> 表名 别名<span class="token number">1</span> <span class="token keyword">inner</span><span class="token operator">/</span><span class="token keyword">left</span><span class="token operator">/</span><span class="token keyword">right</span> <span class="token keyword">join</span> 表名 别名<span class="token number">2</span>
<span class="token keyword">on</span> 别名<span class="token number">1.</span>关联字段 <span class="token operator">=</span> 别名<span class="token number">2</span>的关联字段
<span class="token keyword">where</span> 其他条件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>代码示例：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询员工的编号，姓名，薪资和他领导的编号，姓名，薪资</span>
<span class="token comment">#这些数据全部在员工表中</span>
<span class="token comment">#把t_employee表，即当做员工表，又当做领导表</span>
<span class="token comment">#领导表是虚拟的概念，我们可以通过取别名的方式虚拟</span>
<span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>eid <span class="token string">"员工的编号"</span><span class="token punctuation">,</span>emp<span class="token punctuation">.</span>ename <span class="token string">"员工的姓名"</span> <span class="token punctuation">,</span>emp<span class="token punctuation">.</span>salary <span class="token string">"员工的薪资"</span><span class="token punctuation">,</span>
	mgr<span class="token punctuation">.</span>eid <span class="token string">"领导的编号"</span> <span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>ename <span class="token string">"领导的姓名"</span><span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>salary <span class="token string">"领导的薪资"</span>
<span class="token keyword">FROM</span> t_employee emp <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> t_employee mgr
<span class="token comment">#t_employee emp：如果用emp.，表示的是员工表的</span>
<span class="token comment">#t_employee mgr：如果用mgr.，表示的是领导表的</span>
<span class="token keyword">ON</span> emp<span class="token punctuation">.</span>mid <span class="token operator">=</span> mgr<span class="token punctuation">.</span>eid

<span class="token comment">#表的别名不要加""，给列取别名，可以用""，列的别名不使用""也可以，但是要避免包含空格等特殊符号。</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="7-select语句的7大子句"><a href="#7-select语句的7大子句" class="headerlink" title="7 select语句的7大子句"></a>7 select语句的7大子句</h1><h2 id="7-1-7大子句书写顺序"><a href="#7-1-7大子句书写顺序" class="headerlink" title="7.1 7大子句书写顺序"></a>7.1 7大子句书写顺序</h2><p>（1）from：从哪些表中筛选</p>
<p>（2）on：关联多表查询时，去除笛卡尔积</p>
<p>（3）where：从表中筛选的条件</p>
<p>（4）group by：分组依据</p>
<p>（5）having：在统计结果中再次筛选</p>
<p>（6）order by：排序</p>
<p>（7）limit：分页</p>
<p>必须按照（1）-（7）的顺序【编写】子句。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询每个部门的男生的人数，并且显示人数超过5人的，按照人数降序排列，</span>
<span class="token comment">#每页只能显示10条，我要第2页</span>
<span class="token keyword">SELECT</span> did<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">"人数"</span>
<span class="token keyword">FROM</span> t_employee
<span class="token keyword">WHERE</span> gender <span class="token operator">=</span> <span class="token string">'男'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> did
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">5</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 人数 <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="7-2-group-by与分组函数"><a href="#7-2-group-by与分组函数" class="headerlink" title="7.2 group by与分组函数"></a>7.2 group by与分组函数</h2><p><img src="http://imag.fun-ny.cn/img/1557457869608.png" alt="1557457869608"></p>
<p><strong>可以使用GROUP BY子句将表中的数据分成若干组</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">column</span><span class="token punctuation">,</span> group_function<span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token keyword">table</span>
<span class="token punctuation">[</span><span class="token keyword">WHERE</span>	condition<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">GROUP</span> <span class="token keyword">BY</span>	group_by_expression<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>明确：WHERE一定放在FROM后面GROUP BY 前面</strong></p>
</blockquote>
<p><strong>在SELECT列表中所有未包含在分组函数中的列都应该包含在 GROUP BY子句中</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span>   department_id<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>     employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>包含在 GROUP BY 子句中的列不必包含在SELECT 列表中</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span>   <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>     employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>使用多个列分组</strong></p>
<p><img src="http://imag.fun-ny.cn/img/1557457896747.png" alt="1557457896747"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span>   department_id dept_id<span class="token punctuation">,</span> job_id<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>     employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">,</span> job_id <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h2 id="7-3-having与分组函数"><a href="#7-3-having与分组函数" class="headerlink" title="7.3 having与分组函数"></a>7.3 having与分组函数</h2><p><img src="http://imag.fun-ny.cn/img/1557457922443.png" alt="1557457922443"></p>
<ul>
<li>统计各个部门的平均工资(只显示平均工资2000以上的)</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp   <span class="token comment">-- 1 -- 不是各个部门的，是所有部门的  </span>
<span class="token keyword">select</span> deptno <span class="token keyword">from</span> emp  <span class="token comment">-- 14    </span>
 <span class="token comment">--   14?  1?  字段不能和分组函数共存，除非该字段是分组group by字段  </span>
<span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp    
<span class="token keyword">select</span> deptno<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token comment">--   </span>
<span class="token keyword">from</span>  emp  
<span class="token keyword">group</span> <span class="token keyword">by</span>  deptno<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>获取最小工资小于2000的职位</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">  <span class="token comment">-- min(sal)  job   min(sal)&lt;2000    </span>
  <span class="token comment">-- 获取各个职位的最小工资    </span>
  <span class="token keyword">select</span> job<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span>    
  <span class="token keyword">from</span> emp    
  <span class="token keyword">group</span> <span class="token keyword">by</span> job    
  <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span>    
  
  <span class="token comment">-- 获取各个职位的最小工资,筛选出小于2000的    </span>
  <span class="token keyword">select</span> job<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span>    
  <span class="token keyword">from</span> emp    
  <span class="token keyword">group</span> <span class="token keyword">by</span> job    
  <span class="token keyword">having</span> <span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2000</span>    
  <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span>    
  
<span class="token comment">-- 统计[人数小于4的]部门的平均工资。    </span>
   <span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span>    
   <span class="token keyword">from</span> emp    
   <span class="token keyword">group</span> <span class="token keyword">by</span> deptno    
   <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">4</span>    
<span class="token comment">-- 统计各部门的最高工资，排除最高工资小于3000的部门。    </span>
   <span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span>    
   <span class="token keyword">from</span>  emp    
   <span class="token keyword">group</span> <span class="token keyword">by</span> deptno    
   <span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token number">3000</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>having与where的区别？</p>
<p>（1）where是从表中筛选的条件，而having是分组（统计）结果中再次筛选</p>
<p>（2）where后面不能加“分组/聚合函数”，而having后面可以跟分组函数</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#统计部门平均工资高于8000的部门和平均工资</span>
<span class="token keyword">SELECT</span>   department_id<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>     employees
<span class="token keyword">WHERE</span>    <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">8000</span> <span class="token comment">#错误</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="http://imag.fun-ny.cn/img/1557457937887.png" alt="1557457937887"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#统计每一个部门，薪资高于10000元的女员工的数量，显示人数超过1人</span>
<span class="token keyword">SELECT</span> did<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> t_employee
<span class="token keyword">WHERE</span> gender <span class="token operator">=</span><span class="token string">'女'</span> <span class="token operator">AND</span> salary<span class="token operator">&gt;</span><span class="token number">10000</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> did
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="7-4-order-by"><a href="#7-4-order-by" class="headerlink" title="7.4 order by"></a>7.4 order by</h2><p>order by：</p>
<p>降序：desc</p>
<p>升序：要么默认，要么加asc</p>
<h2 id="7-5-limit"><a href="#7-5-limit" class="headerlink" title="7.5 limit"></a>7.5 limit</h2><p>limit：</p>
<p>limit m,n </p>
<p>m = （第几页 - 1）*每页的数量</p>
<p>n = 每页的数量</p>
<p>代码示例：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">/*
每页显示2条 展示第三页
*/</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">limit</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>求员工的姓名，薪水，部门编号，部门名称，工作编号，工作名称，按照薪水排序，每页显示3条显示第4页</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span>
	emp<span class="token punctuation">.</span><span class="token punctuation">`</span>ename<span class="token punctuation">`</span><span class="token punctuation">,</span>
	emp<span class="token punctuation">.</span><span class="token punctuation">`</span>salary<span class="token punctuation">`</span><span class="token punctuation">,</span>
	emp<span class="token punctuation">.</span><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span><span class="token punctuation">,</span>
	dept<span class="token punctuation">.</span><span class="token punctuation">`</span>dname<span class="token punctuation">`</span><span class="token punctuation">,</span>
	dept<span class="token punctuation">.</span><span class="token punctuation">`</span>did<span class="token punctuation">`</span><span class="token punctuation">,</span>
	job<span class="token punctuation">.</span><span class="token punctuation">`</span>job_name<span class="token punctuation">`</span> 
<span class="token keyword">FROM</span>
	t_employee emp
	<span class="token keyword">JOIN</span> t_department dept <span class="token keyword">ON</span> emp<span class="token punctuation">.</span><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span> <span class="token operator">=</span> dept<span class="token punctuation">.</span><span class="token punctuation">`</span>did<span class="token punctuation">`</span>
	<span class="token keyword">JOIN</span> t_job job <span class="token keyword">ON</span> emp<span class="token punctuation">.</span><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span> <span class="token operator">=</span> job<span class="token punctuation">.</span><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	emp<span class="token punctuation">.</span><span class="token punctuation">`</span>salary<span class="token punctuation">`</span> 
	<span class="token keyword">LIMIT</span> <span class="token number">9</span><span class="token punctuation">,</span>
	<span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="8-子查询"><a href="#8-子查询" class="headerlink" title="8 子查询"></a>8 子查询</h1><p>嵌套在另一个查询中的查询，根据位置不同，分为：where型，from型，exists型。注意：不管子查询在哪里，子查询必须使用()括起来。</p>
<h2 id="1、where型"><a href="#1、where型" class="headerlink" title="1、where型"></a>1、where型</h2><p>①子查询是单值结果，那么可以对其使用（=，&gt;等比较运算符）</p>
<p>②子查询是多值结果，那么可对其使用（【not】in(子查询结果)，或 &gt;all(子查询结果)，或&gt;=all(子查询结果)，&lt;all(子查询结果)，&lt;=all（子查询结果)，或 &gt;any(子查询结果)，或&gt;=any(子查询结果)，&lt;any(子查询结果)，&lt;=any（子查询结果)）</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">查询全公司最高工资的员工信息
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 员工表 <span class="token keyword">where</span> 薪资 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>薪资<span class="token punctuation">)</span> <span class="token keyword">from</span> 员工表<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 员工表 <span class="token keyword">where</span> 薪资 <span class="token operator">&gt;</span> <span class="token keyword">all</span><span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> 员工表  <span class="token keyword">where</span> 员工编号 <span class="token operator">in</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2、from型"><a href="#2、from型" class="headerlink" title="2、from型"></a>2、from型</h2><p>子查询的结果是多行多列的结果，类似于一张表格。</p>
<p>必须给子查询取别名，即临时表名，表的别名不要加“”和空格。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">查询每个部门的编号，名称，平均工资
<span class="token keyword">select</span> 部门编号<span class="token punctuation">,</span> 部门名称， 平均工资
<span class="token keyword">from</span> 部门表 <span class="token keyword">inner</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> 部门编号，<span class="token function">avg</span><span class="token punctuation">(</span>薪资<span class="token punctuation">)</span> <span class="token keyword">from</span> 员工表  <span class="token keyword">group</span> <span class="token keyword">by</span> 部门编号<span class="token punctuation">)</span> <span class="token keyword">temp</span>
<span class="token keyword">on</span> 部门表<span class="token punctuation">.</span>部门编号 <span class="token operator">=</span> <span class="token keyword">temp</span><span class="token punctuation">.</span>部门编号

<span class="token comment">-- 查询每个部门的编号，名称，平均工资</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3、exists型"><a href="#3、exists型" class="headerlink" title="3、exists型"></a>3、exists型</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">查询那些有员工的部门
<span class="token keyword">select</span> 部门编号<span class="token punctuation">,</span> 部门名称 <span class="token keyword">from</span> 部门表
<span class="token keyword">where</span> <span class="token keyword">exists</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 员工表  <span class="token keyword">where</span> 部门表<span class="token punctuation">.</span>部门编号 <span class="token operator">=</span> 员工表<span class="token punctuation">.</span>部门编号<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h1 id="9-事务"><a href="#9-事务" class="headerlink" title="9  事务"></a>9  事务</h1><h2 id="9-1-事务概述"><a href="#9-1-事务概述" class="headerlink" title="9.1 事务概述"></a>9.1 事务概述</h2><p><strong>1、事务处理</strong>（事务操作）：<strong>保证所有事务都作为一个工作单元来执行，即使出现了故障，都不能改变这种执行方式。当在一个事务中执行多个操作时，要么所有的事务都被提交(commit)，那么这些修改就永久地保存下来；要么数据库管理系统将放弃所作的所有修改，整个事务回滚(rollback)到最初状态。</strong></p>
<pre><code> 例如转账操作：A账户要转账给B账户，那么A账户上减少的钱数和B账户上增加的钱数必须一致，也就是说A账户的转出操作和B账户的转入操作要么全部执行，要么全不执行；如果其中一个操作出现异常而没有执行的话，就会导致账户A和账户B的转入转出金额不一致的情况，为而事实上这种情况是不允许发生的，所以为了防止这种情况的发生，需要使用事务处理。
</code></pre>
<p>2、事务的ACID属性：</p>
<p>（1）<strong>原子性（Atomicity）</strong><br>原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。 </p>
<p>（2）<strong>一致性（Consistency）</strong><br>事务必须使数据库从一个一致性状态变换到另外一个一致性状态。</p>
<p>（3）<strong>隔离性（Isolation）</strong><br>事务的隔离性是指一个事务的执行不能被其他事务干扰，即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。</p>
<p>（4）<strong>持久性（Durability）</strong><br>持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来的其他操作和数据库故障不应该对其有任何影响。</p>
<p><img src="http://imag.fun-ny.cn/img/1599461002700.png" alt="1599461002700"></p>
<h2 id="9-2-开启和结束事务"><a href="#9-2-开启和结束事务" class="headerlink" title="9.2 开启和结束事务"></a>9.2 开启和结束事务</h2><p>1、mysql默认是自动提交，执行一句就提交一句。</p>
<p>即默认情况下，每一条sql都是一个独立的sql。</p>
<p>2、我想要手动提交事务：</p>
<p>（1）set autocommit=false; </p>
<p>接下来所有语句都必须手动提交，否则就不会永久生效</p>
<p>（2）start transaction; </p>
<p>…..</p>
<p>commit; 或 rollback; 此次事务结束 想要事务保证数据安全需要再次进行开启</p>
<p>3、注意：</p>
<p>事务的回滚只对DML语句有效，对于DDL语句无效。</p>
<h2 id="9-3-事务隔离级别"><a href="#9-3-事务隔离级别" class="headerlink" title="9.3 事务隔离级别"></a>9.3 事务隔离级别</h2><h3 id="1、事务并发问题"><a href="#1、事务并发问题" class="headerlink" title="1、事务并发问题"></a>1、事务并发问题</h3><p>对于同时运行的多个事务, 当这些事务访问数据库中相同的数据时, 如果没有采取必要的隔离机制, 就会导致各种并发问题:</p>
<ul>
<li><strong>脏读</strong>: 对于两个事务 T1, T2, T1 读取了已经被 T2 更新但还<strong>没有被提交</strong>的字段。 之后, 若 T2 回滚, T1读取的内容就是临时且无效的。</li>
</ul>
<p><img src="http://imag.fun-ny.cn/img/1599461151424.png" alt="1599461151424"></p>
<ul>
<li><strong>不可重复读</strong>: 对于两个事务T1, T2, T1 读取了一个字段, 然后 T2 <strong>更新/修改</strong>了该字段。 之后, T1再次读取同一个字段, 值就不同了。</li>
</ul>
<p><img src="http://imag.fun-ny.cn/img/1599461170319.png" alt="1599461170319"></p>
<ul>
<li><strong>幻读</strong>: 对于两个事务T1, T2, T1 从一个表中读取了一个字段, 然后 T2 在该表中<strong>插入/删除</strong>了一些新的行。 之后, 如果 T1 再次读取同一个表, 就会多/少几行。</li>
</ul>
<p><img src="http://imag.fun-ny.cn/img/1599461184631.png" alt="1599461184631"></p>
<p><em><strong>不可重复度和幻读区别：</strong></em> </p>
<p>不可重复读的重点是修改，幻读的重点在于新增或者删除。 </p>
<p><em><strong>解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表</strong></em> </p>
<p>例1（同样的条件, 你读取过的数据, 再次读取出来发现值不一样了 ）：事务1中的A先生读取自己的工资为 1000的操作还没完成，事务2中的B先生就修改了A的工资为2000，导致A再读自己的工资时工资变为 2000；这就是不可重复读。 </p>
<p>例2（同样的条件, 第1次和第2次读出来的记录数不一样 ）：假某工资单表中工资大于3000的有4人，事务1读取了所有工资大于3000的人，共查到4条记录，这时事务2 又插入了一条工资大于3000的记录，事务1再次读取时查到的记录就变为了5条，这样就导致了幻读 </p>
<h3 id="2、事务隔离级别"><a href="#2、事务隔离级别" class="headerlink" title="2、事务隔离级别"></a>2、事务隔离级别</h3><p><strong>数据库事务的隔离性</strong>：数据库系统必须具有隔离并发运行各个事务的能力, 使它们不会相互影响, 避免各种并发问题。<strong>一个事务与其他事务隔离的程度称为隔离级别。</strong>数据库规定了多种事务隔离级别, 不同隔离级别对应不同的干扰程度, 隔离级别越高, 数据一致性就越好, 但并发性越弱。</p>
<p><strong>数据库提供的 4 种事务隔离级别：</strong></p>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>read-uncommitted</td>
<td>允许A事务读取其他事务未提交和已提交的数据。会出现<em><strong>脏读、不可重复读、幻读</strong></em>问题</td>
</tr>
<tr>
<td>read-committed</td>
<td>只允许A事务读取其他事务已提交的数据。可以避免脏读，但仍然会出现<em><strong>不可重复读、幻读</strong></em>问题</td>
</tr>
<tr>
<td>repeatable-read</td>
<td>确保事务可以多次从一个字段中读取相同的值。在这个事务持续期间，禁止其他事务对这个字段进行更新。可以避免脏读和不可重复读。但是幻读问题仍然存在。</td>
</tr>
<tr>
<td>serializable</td>
<td>确保事务可以从一个表中读取相同的行，相同的记录。在这个事务持续期间，禁止其他事务对该表执行插入、更新、删除操作。所有并发问题都可以避免，但性能十分低下。</td>
</tr>
</tbody></table>
<ul>
<li>Oracle 支持的 2 种事务隔离级别：<strong>READ-COMMITED</strong>, SERIALIZABLE。 Oracle 默认的事务隔离级别为: READ COMMITED 。</li>
<li>Mysql 支持 4 种事务隔离级别。 Mysql 默认的事务隔离级别为: <strong>REPEATABLE-READ</strong>。在mysql中REPEATABLE READ的隔离级别也可以避免幻读了。</li>
</ul>
<h3 id="3、设置和查看隔离级别"><a href="#3、设置和查看隔离级别" class="headerlink" title="3、设置和查看隔离级别"></a>3、设置和查看隔离级别</h3><p>每启动一个 mysql 程序, 就会获得一个单独的数据库连接。每个数据库连接都有一个变量 @@tx_isolation, 表示当前连接的事务隔离级别。mysql服务也有一个全局变量@@global.tx_isolation，表示所有连接的默认事务隔离级别。</p>
<ul>
<li>查看当前mysql连接的隔离级别: </li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">select @@tx_isolation;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>查看全局的隔离级别：</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">select @@global.tx_isolation;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>设置当前 mysql连接的隔离级别:  </li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">set</span> tx_isolation <span class="token operator">=</span><span class="token string">'repeatable-read'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>设置数据库系统的全局的隔离级别:</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">set</span> <span class="token keyword">global</span> tx_isolation <span class="token operator">=</span><span class="token string">'read-committed'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>注意：这里的隔离级别中间是减号，不是下划线。</p>
</blockquote>
<h1 id="10-用户与权限"><a href="#10-用户与权限" class="headerlink" title="10  用户与权限"></a>10  用户与权限</h1><h2 id="10-1-身份认证"><a href="#10-1-身份认证" class="headerlink" title="10.1 身份认证"></a>10.1 身份认证</h2><p>（1）IP+用户名作为身份验证</p>
<pre><code>例如：

    root@localhost：只允许在本机使用root用户登录

    root@%：运行在任意机器上使用root用户登录

    root@192.168.11.56：只运行在192.168.11.56主机上使用root用户登录

    gjz@%：运行在任意机器上使用gjz用户登录
</code></pre>
<blockquote>
<p>建立用户时，用于身份验证的IP地址，是连接你的服务的客户端的IP地址</p>
<p>例如：<a href="mailto:root@192.168.11.56">root@192.168.11.56</a>，表示客户端在192.168.11.56的机器上可以访问你的mysql服务</p>
<p>而这个客户端，要连接你的服务时，-h后面的主机的IP地址是，服务器所在的机器的IP地址。</p>
<p>例如：mysql服务在192.168.11.11机器上，客户端在192.168.11.56上，那么客户端可以用<a href="mailto:root@192.168.11.56">root@192.168.11.56</a>或root@%，连接时填写mysql -h192.168.11.11 -u root -p密码</p>
</blockquote>
<p>（2）密码</p>
<h2 id="10-2-分配权限"><a href="#10-2-分配权限" class="headerlink" title="10.2 分配权限"></a>10.2 分配权限</h2><h3 id="1、用户权限有4个权限级别"><a href="#1、用户权限有4个权限级别" class="headerlink" title="1、用户权限有4个权限级别"></a>1、用户权限有4个权限级别</h3><p>（1）全局</p>
<p>（2）数据库</p>
<p>（3）表</p>
<p>（4）字段</p>
<p>依次校验权限，如果前面通过了，后面就不校验了：</p>
<p>全局 &gt; 数据库 &gt; 表 &gt; 字段</p>
<blockquote>
<p>注意：root@localhost，这个用户始终保留所有的全局权限。</p>
</blockquote>
<h3 id="2、查看账户权限"><a href="#2、查看账户权限" class="headerlink" title="2、查看账户权限"></a>2、查看账户权限</h3><pre class="line-numbers language-none"><code class="language-none">show grants for '用户名'@'主机IP地址';<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="3、新建用户和删除用户"><a href="#3、新建用户和删除用户" class="headerlink" title="3、新建用户和删除用户"></a>3、新建用户和删除用户</h3><p><img src="http://imag.fun-ny.cn/img/1561009788685.png" alt="1561009788685"></p>
<p><img src="http://imag.fun-ny.cn/img/1561009769163.png" alt="1561009769163"></p>
<p>对应的语句：</p>
<pre class="line-numbers language-none"><code class="language-none">CREATE USER '用户名'@'主机IP地址' IDENTIFIED BY '123456';<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>如果主机IP地址写：（1）192.168.29.53，就仅限于在该IP登录</p>
<pre><code>                                （2）%，就表示可以从任意IP登录
</code></pre>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">drop user '用户名'@'主机IP地址';<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h3 id="4、授予和收回权限"><a href="#4、授予和收回权限" class="headerlink" title="4、授予和收回权限"></a>4、授予和收回权限</h3><p><img src="http://imag.fun-ny.cn/img/1561009821823.png" alt="1561009821823"></p>
<p>对应语句：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">GRANT</span> 权限列表 <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'用户名'</span><span class="token variable">@'主机IP地址'</span><span class="token punctuation">;</span>  <span class="token comment">#全局</span>
<span class="token keyword">GRANT</span> 权限列表 <span class="token keyword">ON</span> 数据库名<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'用户名'</span><span class="token variable">@'主机IP地址'</span><span class="token punctuation">;</span> <span class="token comment">#某个库</span>
<span class="token keyword">GRANT</span> 权限列表 <span class="token keyword">ON</span> 数据库名<span class="token punctuation">.</span>表格 <span class="token keyword">TO</span> <span class="token string">'用户名'</span><span class="token variable">@'主机IP地址'</span><span class="token punctuation">;</span> <span class="token comment">#某个库的某个表</span>
<span class="token keyword">GRANT</span> 权限列表 <span class="token keyword">ON</span> 表名<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'用户名'</span><span class="token variable">@'主机IP地址'</span><span class="token punctuation">;</span>  <span class="token comment">#某个表的字段</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>例如：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'gao'</span><span class="token variable">@'192.168.29.53'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span> <span class="token keyword">ON</span> <span class="token punctuation">`</span>test<span class="token punctuation">`</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'gao'</span><span class="token variable">@'192.168.29.53'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">UPDATE</span> <span class="token keyword">ON</span> <span class="token punctuation">`</span>test<span class="token punctuation">`</span><span class="token punctuation">.</span><span class="token punctuation">`</span>t_department<span class="token punctuation">`</span> <span class="token keyword">TO</span> <span class="token string">'gao'</span><span class="token variable">@'192.168.29.53'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">UPDATE</span> <span class="token keyword">ON</span> <span class="token punctuation">`</span>t_department<span class="token punctuation">`</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'gao'</span><span class="token variable">@'192.168.29.53'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span> <span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span> <span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">UPDATE</span> <span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">REFERENCES</span> <span class="token punctuation">(</span>tid<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token punctuation">`</span><span class="token number">1101</span>db<span class="token punctuation">`</span><span class="token punctuation">.</span><span class="token punctuation">`</span>course<span class="token punctuation">`</span> <span class="token keyword">TO</span> <span class="token string">'gao'</span><span class="token variable">@'192.168.29.30'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>收回权限：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">revoke</span> 权限列表 <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'用户名'</span><span class="token variable">@'主机IP地址'</span><span class="token punctuation">;</span>
<span class="token keyword">revoke</span> 权限列表 <span class="token keyword">ON</span> 数据库名<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'用户名'</span><span class="token variable">@'主机IP地址'</span><span class="token punctuation">;</span>
<span class="token keyword">revoke</span> 权限列表 <span class="token keyword">ON</span> 数据库名<span class="token punctuation">.</span>表格 <span class="token keyword">from</span> <span class="token string">'用户名'</span><span class="token variable">@'主机IP地址'</span><span class="token punctuation">;</span>
<span class="token keyword">revoke</span> 权限列表 <span class="token keyword">ON</span> 表名<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'用户名'</span><span class="token variable">@'主机IP地址'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="11-数据库设计的三大范式（附加）"><a href="#11-数据库设计的三大范式（附加）" class="headerlink" title="11  数据库设计的三大范式（附加）"></a>11  数据库设计的三大范式（附加）</h1><h2 id="1-范式"><a href="#1-范式" class="headerlink" title="1) 范式"></a><strong>1)</strong> 范式</h2><p>• 必须保证数据库设计的合理性</p>
<pre><code>       数据库设计关系整个系统的架构，关系到后续开发效率和运行效率

       数据库的设计主要包含了设计表结构和表之间的联系
</code></pre>
<p>• 如何是合理数据库</p>
<pre><code>      结构合理

      冗余较小

      尽量避免插入删除修改异常
</code></pre>
<p>• 如何才能保证数据库设计水平</p>
<pre><code>      遵循一定的规则

       在关系型数据库中这种规则就称为***范式*** 
</code></pre>
<p>• 什么是范式（NF= NormalForm）</p>
<pre><code>       范式是符合某一种设计要求的总结。

       要想设计一个结构合理的关系型数据库，必须满足一定的范式。
</code></pre>
<h2 id="2-范式分类"><a href="#2-范式分类" class="headerlink" title="2) 范式分类"></a><strong>2)</strong> 范式分类</h2><p>• 第一范式</p>
<p>• 第二范式</p>
<p>• 第三范式</p>
<pre><code>     • 各个范式是依次嵌套包含的

     • 范式越高，设计质量越高，在现实设计中也越难实现

     • 一般数据库设计，只要达到第三范式，即可避免异常的出现 
</code></pre>
<h2 id="3-第一范式"><a href="#3-第一范式" class="headerlink" title="3) 第一范式"></a><strong>3)</strong> 第一范式</h2><p>• 要求</p>
<ul>
<li> 最基本的范式</li>
<li> 数据库表每一列都是不可分割基本数据项，同一列中不能有多个值</li>
<li> 简单说就是要确保每列保持原子性</li>
<li> 第一范式的合理遵循需要根据系统的实际需求来定</li>
</ul>
<p>• 示例</p>
<ul>
<li> 用户表（用户名，家庭地址）</li>
<li> 用户表（用户名，省，城市，详细地址）</li>
<li> 系（系名称，系主任，系高级职称人数）</li>
<li> 系（系名称，系主任，系教授人数，系副教授人数） </li>
</ul>
<h2 id="4-第二范式"><a href="#4-第二范式" class="headerlink" title="4) 第二范式"></a><strong>4)</strong> 第二范式</h2><p>• 要求</p>
<ul>
<li>第二范式需要确保数据库表中的每一列都和主键相关，而不能只与主键的某一部分相关（主要针对联合主键而言）。</li>
<li>即在一个数据库表中只能保存一种数据，不可以把多种数据保存在同一张数据库表中。</li>
</ul>
<p>• 示例</p>
<ul>
<li>学号和课程编号作为联合主键</li>
<li><font color="red">课程名称只依赖于课程编号，而和学号没有关系</font></li>
</ul>
<p><img src="http://imag.fun-ny.cn/img/wps15.jpg" alt="img"> </p>
<p>• 解决</p>
<ul>
<li>提取出学生表</li>
<li>提取成课程表</li>
<li>提取选课表，存放选课记录</li>
</ul>
<p><img src="http://imag.fun-ny.cn/img/wps16.jpg" alt="img"> </p>
<pre><code>学生表           选课表         课程表
</code></pre>
<h2 id="5-第三范式"><a href="#5-第三范式" class="headerlink" title="5) 第三范式"></a><strong>5)</strong> <em><strong>第三范式</strong></em></h2><p>• 要求</p>
<ul>
<li>确保数据表中的每一列数据都和主键直接相关，而不能间接相关</li>
<li>属性不依赖于其他非主属性。</li>
</ul>
<p>• 示例1：学生班级表 </p>
<table>
<thead>
<tr>
<th>学号(主键)</th>
<th>学生姓名</th>
<th>班级编号</th>
<th>班级名称</th>
<th>班级信息</th>
</tr>
</thead>
<tbody><tr>
<td>023145</td>
<td>张三</td>
<td>987654</td>
<td>3班</td>
<td>特招班</td>
</tr>
<tr>
<td>023146</td>
<td>李四</td>
<td>987654</td>
<td>3班</td>
<td>特招班</td>
</tr>
<tr>
<td>023147</td>
<td>王五</td>
<td>987655</td>
<td>4班</td>
<td>普通班</td>
</tr>
<tr>
<td>023258</td>
<td>赵六</td>
<td>987654</td>
<td>3班</td>
<td>特招班</td>
</tr>
</tbody></table>
<p>完善之后的方案：</p>
<table>
<thead>
<tr>
<th>学号(主键)</th>
<th>学生姓名</th>
<th>班级编号</th>
</tr>
</thead>
<tbody><tr>
<td>023145</td>
<td>张三</td>
<td>987654</td>
</tr>
<tr>
<td>023146</td>
<td>李四</td>
<td>987654</td>
</tr>
<tr>
<td>023147</td>
<td>王五</td>
<td>987655</td>
</tr>
<tr>
<td>023258</td>
<td>赵六</td>
<td>987654</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>班级编号(主键)</th>
<th>班级名称</th>
<th>班级信息</th>
</tr>
</thead>
<tbody><tr>
<td>987654</td>
<td>3班</td>
<td>特招班</td>
</tr>
<tr>
<td>987655</td>
<td>4班</td>
<td>普通班</td>
</tr>
</tbody></table>
<p>• 示例2:订单明细表</p>
<table>
<thead>
<tr>
<th>编号(主键)</th>
<th>图书id</th>
<th>图书名称</th>
<th>价格</th>
<th>作者</th>
<th>出版社</th>
<th>出版日期</th>
<th>数量</th>
</tr>
</thead>
<tbody><tr>
<td>023145</td>
<td>1</td>
<td>精通Java</td>
<td>60.00</td>
<td>张三</td>
<td>清华出版社</td>
<td>2007</td>
<td>1</td>
</tr>
<tr>
<td>023146</td>
<td>2</td>
<td>Oracle</td>
<td>65.00</td>
<td>李四</td>
<td>机械出版社</td>
<td>2009</td>
<td>1</td>
</tr>
<tr>
<td>023147</td>
<td>3</td>
<td>JSP</td>
<td>87</td>
<td>王五</td>
<td>电子出版社</td>
<td>2014</td>
<td>3</td>
</tr>
<tr>
<td>023258</td>
<td>1</td>
<td>精通Java</td>
<td>60.00</td>
<td>张三</td>
<td>清华出版社</td>
<td>2007</td>
<td>2</td>
</tr>
<tr>
<td>023259</td>
<td>2</td>
<td>Oracle</td>
<td>65.00</td>
<td>李四</td>
<td>机械出版社</td>
<td>2009</td>
<td>3</td>
</tr>
</tbody></table>
<p>完善之后的方案：分割成图书表和订单表两种表</p>
<table>
<thead>
<tr>
<th>图书id</th>
<th>图书名称</th>
<th>价格</th>
<th>作者</th>
<th>出版社</th>
<th>出版日期</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>精通Java</td>
<td>60.00</td>
<td>张三</td>
<td>清华出版社</td>
<td>2007</td>
</tr>
<tr>
<td>2</td>
<td>Oracle</td>
<td>65.00</td>
<td>李四</td>
<td>机械出版社</td>
<td>2009</td>
</tr>
<tr>
<td>3</td>
<td>JSP</td>
<td>87</td>
<td>王五</td>
<td>电子出版社</td>
<td>2014</td>
</tr>
<tr>
<td>4</td>
<td>Struts2</td>
<td>56</td>
<td>赵六</td>
<td>清华出版社</td>
<td>2005</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>编号(主键)</th>
<th>图书id</th>
<th>数量</th>
</tr>
</thead>
<tbody><tr>
<td>023145</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>023146</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>023147</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>023258</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>023259</td>
<td>2</td>
<td>3</td>
</tr>
</tbody></table>
<h2 id="6-范式的优缺点"><a href="#6-范式的优缺点" class="headerlink" title="6) 范式的优缺点"></a><strong>6)</strong> 范式的优缺点</h2><p>• 优点</p>
<ul>
<li> 结构合理</li>
<li> 冗余较小</li>
<li> 尽量避免插入删除修改异常</li>
</ul>
<p>• 缺点</p>
<ul>
<li> 性能降低</li>
<li> 多表查询比单表查询速度慢</li>
<li> 数据库的设计应该根据当前情况和需求做出灵活的处理。</li>
<li> 在实际设计中，要整体遵循范式理论。</li>
<li> 如果在某些特定的情况下还死死遵循范式也是不可取的，因为可能降低数据库的效率，此时可以<em><strong>适当增加冗余而提高性能。</strong></em></li>
</ul>
<p>• 示例：</p>
<pre><code>  比如经常购物车条目的中除了条目编号，商品编号，商品数量外，可以增加经常使用的商品名称，商品价格等
</code></pre>
<p>图书表</p>
<table>
<thead>
<tr>
<th>图书id</th>
<th>图书名称</th>
<th>价格</th>
<th>作者</th>
<th>出版社</th>
<th>出版日期</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>精通Java</td>
<td>60</td>
<td>张三</td>
<td>清华出版社</td>
<td>2007</td>
</tr>
<tr>
<td>2</td>
<td>Oracle宝典</td>
<td>65</td>
<td>李四</td>
<td>机械出版社</td>
<td>2009</td>
</tr>
<tr>
<td>3</td>
<td>JSP</td>
<td>87</td>
<td>王五</td>
<td>电子出版社</td>
<td>2014</td>
</tr>
<tr>
<td>4</td>
<td>Struts2</td>
<td>56</td>
<td>赵六</td>
<td>清华出版社</td>
<td>2005</td>
</tr>
</tbody></table>
<p>订单表中增加冗余列图书名称、价格，以空间换时间。</p>
<table>
<thead>
<tr>
<th>编号(主键)</th>
<th>图书id</th>
<th>图书名称</th>
<th>价格</th>
<th>数量</th>
</tr>
</thead>
<tbody><tr>
<td>023145</td>
<td>1</td>
<td>精通Java</td>
<td>60</td>
<td>1</td>
</tr>
<tr>
<td>023146</td>
<td>2</td>
<td>Oracle宝典</td>
<td>65</td>
<td>1</td>
</tr>
<tr>
<td>023147</td>
<td>3</td>
<td>JSP</td>
<td>87</td>
<td>3</td>
</tr>
<tr>
<td>023258</td>
<td>1</td>
<td>精通Java</td>
<td>60</td>
<td>2</td>
</tr>
</tbody></table>
<h2 id="7-总结"><a href="#7-总结" class="headerlink" title="7) 总结"></a><strong>7)</strong> <em><strong>总结</strong></em></h2><p>• 范式是指导数据设计的规范化理论，可以保证数据库设计质量</p>
<p>• 第一范式：字段不能再分</p>
<p>• 第二范式：不存在局部依赖</p>
<p>• 第三范式：不含传递依赖（间接依赖）</p>
<p>• 使用范式可以减少冗余，但是会降低性能</p>
<p>• 特定表的的设计可以违反第三范式，增加冗余提高性能</p>
<h1 id="12-经典问题-出现问题时与之对应"><a href="#12-经典问题-出现问题时与之对应" class="headerlink" title="12  经典问题(出现问题时与之对应)"></a>12  经典问题(出现问题时与之对应)</h1><h2 id="1、编码问题"><a href="#1、编码问题" class="headerlink" title="1、编码问题"></a>1、编码问题</h2><h3 id="命令行操作sql乱码问题"><a href="#命令行操作sql乱码问题" class="headerlink" title="命令行操作sql乱码问题"></a>命令行操作sql乱码问题</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_stu <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1366</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Incorrect string <span class="token keyword">value</span>: <span class="token string">'\xD5\xC5\xC8\xFD'</span> <span class="token keyword">for</span> <span class="token keyword">column</span> <span class="token string">'sname'</span> at <span class="token keyword">row</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="修改my-ini配置文件"><a href="#修改my-ini配置文件" class="headerlink" title="修改my.ini配置文件"></a>修改my.ini配置文件</h3><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">在路径：C:\ProgramData\MySQL\MySQL Server 5.7\my.ini 找到my.ini文件

修改内容1：
	找到[mysql]命令，大概在63行左右，在其下一行添加 
		<span class="token key attr-name">default-character-set</span><span class="token punctuation">=</span><span class="token value attr-value">utf8</span>
修改内容2:
	找到[mysqld]命令，大概在76行左右，在其下一行添加
		<span class="token key attr-name">character-set-server</span><span class="token punctuation">=</span><span class="token value attr-value">utf8</span>
		<span class="token key attr-name">collation-server</span><span class="token punctuation">=</span><span class="token value attr-value">utf8_general_ci</span>

修改完毕后，重启MySQL57服务<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>查看编码命令</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'character_%'</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'collation_%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="http://imag.fun-ny.cn/img/MySQL%E7%BC%96%E7%A0%811.jpg"></p>
<p><img src="http://imag.fun-ny.cn/img/MySQL%E7%BC%96%E7%A0%812.jpg"></p>
<ul>
<li>如果是以上配置就说明对了</li>
</ul>
<h3 id="命令行操作sql仍然乱码问题"><a href="#命令行操作sql仍然乱码问题" class="headerlink" title="命令行操作sql仍然乱码问题"></a>命令行操作sql仍然乱码问题</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_stu <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1366</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Incorrect string <span class="token keyword">value</span>: <span class="token string">'\xD5\xC5\xC8\xFD'</span> <span class="token keyword">for</span> <span class="token keyword">column</span> <span class="token string">'sname'</span> at <span class="token keyword">row</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>原因：按照刚才的配置，服务器端认为你的客户端的字符集是utf-8，而实际上你的客户端的字符集是GBK。</p>
<p><img src="http://imag.fun-ny.cn/img/1557458006195.png" alt="1557458006195"></p>
<p>查看所有字符集：<strong>SHOW VARIABLES LIKE ‘character_set_%’;</strong></p>
<p><img src="http://imag.fun-ny.cn/img/1557458019409.png" alt="1557458019409"></p>
<p>解决方案，设置当前连接的客户端字符集 <strong>“SET NAMES GBK;”</strong></p>
<p>set names gbk;是为了告诉服务器,客户端用的GBK编码,防止乱码。</p>
<p><img src="http://imag.fun-ny.cn/img/1557458032334.png" alt="1557458032334"></p>
<p>有的时候，这样还不能解决，例如，某些win10操作系统环境下，那么修改命令行的属性-》选项-》勾选使用旧版控制台，然后重启电脑</p>
<p><img src="http://imag.fun-ny.cn/img/1560996958604.png" alt="1560996958604"></p>
<h2 id="2、忘记root用户密码问题"><a href="#2、忘记root用户密码问题" class="headerlink" title="2、忘记root用户密码问题"></a>2、忘记root用户密码问题</h2><p>1:通过任务管理器或者服务管理,关掉mysqld(服务进程)</p>
<p>2:通过命令行+特殊参数开启mysqld</p>
<p>mysql5.5</p>
<pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">mysqld --skip-grant-tables<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>mysql5.7版</p>
<pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">mysqld --defaults-file="D:\ProgramFiles\mysql\MySQLServer5.7Data\my.ini" --skip-grant-tables<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>此处路径以你自己的世界路径为准</p>
</blockquote>
<p>3:此时,mysqld服务进程已经打开,并且,不需要权限检查.</p>
<p>4:mysql -uroot  无密码登陆服务器.另启动一个客户端进行</p>
<p>5: 修改权限表</p>
<p> （1） use mysql;</p>
<p>（2）</p>
<p>mysql5.5版</p>
<pre class="line-numbers language-none"><code class="language-none">update user set Password = password('123456') where User = 'root';<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>mysql5.7版</p>
<pre class="line-numbers language-none"><code class="language-none">update user set authentication_string=password('新密码') where user='root' and Host='localhost'; <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>​           </p>
<p>  （3）flush privileges;</p>
<p>6:通过任务管理器,关掉mysqld服务进程.</p>
<p>7:再次通过服务管理,打mysql服务。</p>
<p>8:即可用修改后的新密码登陆.</p>
<h2 id="3、查看字符集和校对规则"><a href="#3、查看字符集和校对规则" class="headerlink" title="3、查看字符集和校对规则"></a>3、查看字符集和校对规则</h2><p>关于SQL的关键字和函数名等不区分大小写，但是对于数据值是否区分大小写，和字符集与校对规则有关。</p>
<p>_ci（大小写不敏感），_cs（大小写敏感），_bin（二元，即比较是基于字符编码的值而与language无关）</p>
<p>（1）查看所有字符集和校对规则</p>
<p><img src="http://imag.fun-ny.cn/img/wps1.jpg" alt="img"> </p>
<p>（2）查看GBK和UTF-8字符集的校对规则</p>
<p>show collation like ‘gbk%’;</p>
<p><img src="http://imag.fun-ny.cn/img/wps2.jpg" alt="img"> </p>
<p>show collation like ‘utf8%’;</p>
<p><img src="http://imag.fun-ny.cn/img/wps3.jpg" alt="img"> </p>
<p>utf8_unicode_ci和utf8_general_ci对中、英文来说没有实质的差别。<br>utf8_general_ci 校对速度快，但准确度稍差。<br>utf8_unicode_ci 准确度高，但校对速度稍慢。</p>
<p>如果你的应用有德语、法语或者俄语，请一定使用utf8_unicode_ci。一般用utf8_general_ci就够了。</p>
<p>（3）查看服务器的字符集和校对规则</p>
<p><img src="http://imag.fun-ny.cn/img/wps4.jpg" alt="img"> </p>
<p>（4）查看和修改某个数据库的字符集和校对规则</p>
<p><img src="http://imag.fun-ny.cn/img/wps5.jpg" alt="img"> </p>
<p>或</p>
<p><img src="http://imag.fun-ny.cn/img/wps6.jpg" alt="img"> </p>
<p>修改数据库的字符集和校对规则：</p>
<p>ALTER DATABASE 数据库名称 DEFAULT CHARACTER SET 字符集名称 【COLLATE 校对规则名称】;</p>
<p>例如：</p>
<p>ALTER DATABASE ceshi_db DEFAULT CHARACTER SET utf8 collate utf8_general_ci;</p>
<p><img src="http://imag.fun-ny.cn/img/wps7.jpg" alt="img"> </p>
<p>注意：修改了数据库的默认字符集和校对规则后，原来已经创建的表格的字符集和校对规则并不会改变，如果需要，那么需要单独修改。</p>
<p>（5）查看某个表格的字符集和校对规则</p>
<p>查看字符集：show create table users;</p>
<p><img src="http://imag.fun-ny.cn/img/wps8.jpg" alt="img"> </p>
<p>如果要查看校对规则：show table status from bookstore like ‘%users%’ ;</p>
<p><img src="http://imag.fun-ny.cn/img/wps9.jpg" alt="img"> </p>
<p>修改某个表格的字符集和校对规则：</p>
<p>修改表的默认字符集：</p>
<p>ALTER TABLE 表名称 DEFAULT CHARACTER SET 字符集名称 【COLLATE 校对规则名称】;</p>
<p>把表默认的字符集和所有字符列（CHAR,VARCHAR,TEXT）改为新的字符集：</p>
<p>ALTER TABLE 表名称 CONVERT TO CHARACTER SET 字符集名称 【COLLATE 校对规则名称】;</p>
<p>例如：ALTER TABLE ceshi_table DEFAULT CHARACTER SET gbk collate gbk_chinese_ci;</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">fun-ny</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://fun-ny.cn/2021/12/07/mysql-bi-ji/">https://fun-ny.cn/2021/12/07/mysql-bi-ji/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">fun-ny</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Mysql/">
                                    <span class="chip bg-color">Mysql</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/12/13/jdbc-xue-xi-ji-lu/">
                    <div class="card-image">
                        
                        <img src="https://imag.fun-ny.cn/infinity-1212213.jpg" class="responsive-img" alt="JDBC学习记录">
                        
                        <span class="card-title">JDBC学习记录</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            虽然现在并不使用JDBC直接操作数据库，但是多了解一些总是好的，毕竟框架也是在这个基础上构建的
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-12-13
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Java/" class="post-category">
                                    Java
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/JDBC/">
                        <span class="chip bg-color">JDBC</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/12/07/abap-za-xiang/">
                    <div class="card-image">
                        
                        <img src="https://imag.fun-ny.cn/infinity-2812431.png" class="responsive-img" alt="ABAP杂项">
                        
                        <span class="card-title">ABAP杂项</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            主要用来记录ABAP中的一些奇淫技巧
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-12-07
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/ABAP/" class="post-category">
                                    ABAP
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ABAP/">
                        <span class="chip bg-color">ABAP</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">fun-ny</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">115.6k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="https://beian.miit.gov.cn" target="_blank">豫ICP备2021035072号</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/fanli1106" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:fanli918@outlook.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1778803286" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1778803286" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    
    
    <script type="text/javascript" size="150" alpha='0.6'
        zIndex="-1" src="/libs/background/ribbon-refresh.min.js" async="async"></script>
    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
